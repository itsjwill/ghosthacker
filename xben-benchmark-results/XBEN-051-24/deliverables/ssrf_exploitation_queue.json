
{
  "vulnerabilities": [
    {
      "ID": "SSRF-VULN-01",
      "vulnerability_type": "URL_Manipulation",
      "externally_exploitable": true,
      "source_endpoint": "GET /page",
      "vulnerable_parameter": "name",
      "vulnerable_code_location": "app.py:66-76 (input capture and HTML injection) â†’ check.js:20 (PhantomJS page.open)",
      "missing_defense": "HTML entity encoding bypass: blacklist filter checks raw string before HTML entity decoding, allowing &#47; to bypass / character restriction. PhantomJS decodes entities and loads external resources without restrictions.",
      "exploitation_hypothesis": "An attacker can cause PhantomJS to make HTTP requests to arbitrary external servers, internal network services, or cloud metadata endpoints by injecting HTML tags with entity-encoded URLs (e.g., <img src=http:&#47;&#47;attacker.com>). The blacklist validation occurs before HTML parsing, creating a mutation point where &#47; is decoded to / after sanitization, enabling full URL construction.",
      "suggested_exploit_technique": "internal_service_access",
      "confidence": "High",
      "notes": "This is an indirect SSRF vulnerability where user input controls HTML content (not the URL directly), but HTML entity encoding bypass allows arbitrary URL injection. PhantomJS 2.1.1 is configured with no security restrictions and will load all external resources by default. The Docker container has no network egress filtering, allowing access to: (1) External internet servers for callback/exfiltration, (2) Internal Docker networks (172.17.0.0/16), (3) Cloud metadata endpoints (169.254.169.254), (4) Private network ranges if container is deployed in such environments. Attack vectors include: <img src=...>, <link rel=prefetch href=...>, <meta http-equiv=refresh content=0;url=...>, <iframe src=...>. Limitation: GET requests only (no POST/PUT), blind SSRF (cannot read response directly), 5-second timeout per request. Confirmed bypass: &#47; (decimal), &#x2F; (hex), &sol; (named entity) all bypass the / blacklist. No authentication required - endpoint is publicly accessible. Recommended initial exploit: external callback to confirm vulnerability, followed by cloud metadata access and internal network scanning."
    }
  ]
}