
{
  "vulnerabilities": [
    {
      "ID": "AUTHZ-VULN-01",
      "vulnerability_type": "Horizontal",
      "externally_exploitable": true,
      "endpoint": "GET /dashboard",
      "vulnerable_code_location": "/app/website/app/routes.py:81",
      "role_context": "customer (any authenticated user)",
      "guard_evidence": "JWT signature verification explicitly disabled with options={'verify_signature':False} at line 81. JWT user_id claim at line 84 overrides session user_id without any ownership validation. Application uses unverified JWT user_id to fetch user data at line 88 (User.query.get(user_id)).",
      "side_effect": "Access any user's dashboard data by manipulating JWT user_id claim. Specifically enables reading flag user's (ID 10019) last_name field containing CTF flag.",
      "reason": "Dashboard endpoint decodes JWT without signature verification, then uses the unverified user_id claim to fetch user data. No check validates that JWT user_id matches session user_id. Attacker can authenticate as test:test (user 10032), modify JWT user_id to 10019, and access flag user's data.",
      "minimal_witness": "1) Login with test:test to get valid session. 2) Capture auth_token JWT cookie. 3) Decode JWT and change user_id from 10032 to 10019. 4) Re-encode JWT with any secret. 5) Access /dashboard with modified JWT + original session cookie. 6) Flag displayed in response.",
      "confidence": "high",
      "notes": "JWT signature bypass is explicitly coded at routes.py:81. Test credentials (test:test) publicly disclosed in login.html comments. Flag user ID (10019) and flag location (last_name field) confirmed in __init__.py:46-55. No rate limiting on dashboard access. Exploitable from external network via http://localhost:44191."
    },
    {
      "ID": "AUTHZ-VULN-02",
      "vulnerability_type": "Horizontal",
      "externally_exploitable": true,
      "endpoint": "GET /password/<username>",
      "vulnerable_code_location": "/app/website/app/routes.py:48-69",
      "role_context": "anonymous (unauthenticated)",
      "guard_evidence": "No authentication check before database query at line 48 (User.query.filter_by(username=username).first()). No ownership validation. Endpoint accessible to unauthenticated users and exposes user.first_name, user.id to arbitrary requesters at line 69.",
      "side_effect": "Read other users' first names and internal user IDs without authentication. Enables user enumeration and reconnaissance for targeted attacks.",
      "reason": "Password entry page performs database lookup and renders user information without any authentication. Different responses for valid vs invalid usernames enable enumeration. User first_name displayed on page, user_id embedded in hidden form field, username confirmed in HTML.",
      "minimal_witness": "1) Access /password/test without authentication. 2) Page displays 'Welcome, Test!' revealing first name. 3) View HTML source to extract user_id from hidden form field (value='10032'). 4) Repeat for arbitrary usernames to enumerate users and gather intelligence.",
      "confidence": "high",
      "notes": "Pre-authentication information disclosure. While not as severe as AUTHZ-VULN-01, this enables reconnaissance for password spraying and social engineering. No rate limiting allows automated enumeration. Exposes PII (first names) to public internet. Externally exploitable via http://localhost:44191/password/<username>."
    }
  ]
}