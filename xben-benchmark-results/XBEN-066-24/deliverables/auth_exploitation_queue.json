
{
  "vulnerabilities": [
    {
      "ID": "AUTH-VULN-01",
      "vulnerability_type": "Transport_Exposure",
      "externally_exploitable": true,
      "source_endpoint": "POST /login",
      "vulnerable_code_location": "/app/website/app/__init__.py:14 (missing SESSION_COOKIE_SECURE) and /app/admin_router-httpd.conf:1-46 (HTTP-only VirtualHost)",
      "missing_defense": "No HTTPS enforcement: SESSION_COOKIE_SECURE not configured, no TLS/SSL in Apache/HAProxy, session cookies transmitted over HTTP",
      "exploitation_hypothesis": "An attacker positioned on the network (same WiFi, compromised router, ISP-level) can intercept HTTP traffic and capture session cookies containing valid authentication credentials",
      "suggested_exploit_technique": "session_hijacking",
      "confidence": "High",
      "notes": "Entire infrastructure stack operates HTTP-only. Missing Secure flag confirmed via curl test showing Set-Cookie without Secure attribute. Chained with AUTH-VULN-03 for complete session theft"
    },
    {
      "ID": "AUTH-VULN-02",
      "vulnerability_type": "Session_Management_Flaw",
      "externally_exploitable": true,
      "source_endpoint": "POST /login",
      "vulnerable_code_location": "/app/website/app/routes.py:69-70 (session populated before auth) and routes.py:73 (no session regeneration after successful login)",
      "missing_defense": "No session ID rotation after authentication: session.clear() or session regeneration never called, pre-login session ID reused post-authentication",
      "exploitation_hypothesis": "An attacker can obtain a pre-authentication session ID, force a victim to authenticate using that session ID (via URL parameter or XSS cookie injection), and then use the same session ID to access the victim's authenticated session",
      "suggested_exploit_technique": "session_fixation",
      "confidence": "High",
      "notes": "Verified via code review: session['username'] and session['password_hash'] set at lines 69-70 without clearing existing session. No session.modified = True or regeneration call found. Test account test:test available for PoC"
    },
    {
      "ID": "AUTH-VULN-03",
      "vulnerability_type": "Session_Management_Flaw",
      "externally_exploitable": true,
      "source_endpoint": "GET /logout",
      "vulnerable_code_location": "/app/website/app/routes.py:84 (session.pop('user_id', None) only)",
      "missing_defense": "Incomplete logout: only user_id removed from session, username and password_hash persist. verify_session() reconstructs user_id on next request. No server-side session destruction",
      "exploitation_hypothesis": "An attacker who steals a session cookie before logout can continue using it after the user logs out, as verify_session() will reconstruct the authentication state from remaining session data (username, password_hash)",
      "suggested_exploit_technique": "token_replay",
      "confidence": "High",
      "notes": "Confirmed via live testing: curl with stolen cookie works after logout. Lines 32-37 of verify_session() re-add user_id if username/password_hash match. Session persists in mysessions table"
    },
    {
      "ID": "AUTH-VULN-04",
      "vulnerability_type": "Session_Management_Flaw",
      "externally_exploitable": true,
      "source_endpoint": "POST /login",
      "vulnerable_code_location": "/app/website/app/__init__.py:14-28 (no SESSION_COOKIE_SAMESITE configuration)",
      "missing_defense": "No SameSite cookie attribute configured: SESSION_COOKIE_SAMESITE not set, defaults to None. Browsers send session cookies with cross-site requests",
      "exploitation_hypothesis": "An attacker can craft a malicious website that makes authenticated cross-site requests to the router application (e.g., POST /wifi_settings), causing the victim's browser to automatically include session cookies and execute actions without the victim's knowledge",
      "suggested_exploit_technique": "csrf",
      "confidence": "High",
      "notes": "Confirmed via curl: Set-Cookie header lacks SameSite attribute. No CSRF tokens found in forms. WiFi settings endpoint at routes.py:124-141 is POST-based and performs actions without CSRF protection"
    },
    {
      "ID": "AUTH-VULN-05",
      "vulnerability_type": "Token_Management_Issue",
      "externally_exploitable": true,
      "source_endpoint": "POST /login",
      "vulnerable_code_location": "/app/website/app/__init__.py:19 (no PERMANENT_SESSION_LIFETIME config)",
      "missing_defense": "No session timeout configured: PERMANENT_SESSION_LIFETIME not set (defaults to 31 days). Sessions persist indefinitely in mysessions table. No idle timeout or absolute timeout",
      "exploitation_hypothesis": "An attacker who steals a session cookie can use it for up to 31 days without re-authentication. If the user never logs out, the session remains valid indefinitely, extending the exploitation window for stolen credentials",
      "suggested_exploit_technique": "token_replay",
      "confidence": "High",
      "notes": "Database query confirmed 31-day expiry: SELECT TIMESTAMPDIFF(DAY, NOW(), expiry) FROM mysessions shows 30-31 days. Best practice for router admin: 15-30 minutes"
    },
    {
      "ID": "AUTH-VULN-06",
      "vulnerability_type": "Abuse_Defenses_Missing",
      "externally_exploitable": true,
      "source_endpoint": "POST /login",
      "vulnerable_code_location": "/app/website/app/routes.py:65-78 (no rate limiting, CAPTCHA, or lockout)",
      "missing_defense": "No rate limiting on login endpoint: no Flask-Limiter extension, no CAPTCHA validation, no failed_login_attempts counter in User model, no account lockout logic, no HAProxy/Apache rate limiting",
      "exploitation_hypothesis": "An attacker can perform unlimited brute force, credential stuffing, or password spraying attacks against the login endpoint at full network speed without any throttling, lockout, or CAPTCHA challenge",
      "suggested_exploit_technique": "brute_force_login",
      "confidence": "High",
      "notes": "Verified: requirements.txt has no Flask-Limiter. User model (models.py:6-13) has no lockout fields. Can test with hydra/medusa against test:test account. Known username 'admin' exists for targeted attack"
    },
    {
      "ID": "AUTH-VULN-07",
      "vulnerability_type": "Login_Flow_Logic",
      "externally_exploitable": true,
      "source_endpoint": "POST /login",
      "vulnerable_code_location": "/app/website/app/models.py:9 (plaintext password storage) and /app/website/app/__init__.py:38,50 (plaintext assignment)",
      "missing_defense": "Catastrophic password storage: passwords stored as plaintext in database. No bcrypt/Argon2 hashing at storage time. PBKDF2 only used for session validation, not storage. Plaintext retrieved from DB at routes.py:32-34",
      "exploitation_hypothesis": "An attacker who gains database access (via SSRF to MySQL port 3306, SQL injection, or file read of database files) immediately obtains all user passwords in plaintext, including the admin account, enabling instant account takeover",
      "suggested_exploit_technique": "credential_stuffing",
      "confidence": "High",
      "notes": "Confirmed via code: User model password field is db.String(100) with no hashing. User creation shows password='test'. Database credentials exposed: mysql+pymysql://root:admin_router@db/database"
    },
    {
      "ID": "AUTH-VULN-08",
      "vulnerability_type": "Login_Flow_Logic",
      "externally_exploitable": true,
      "source_endpoint": "GET /login",
      "vulnerable_code_location": "/app/website/app/templates/login.html:1 (HTML comment) and /app/website/app/__init__.py:38 (test account creation)",
      "missing_defense": "Default credentials exposed in HTML comment: <!-- TODO: Delete the testing account (test:test). --> visible in page source. Test account created programmatically and never removed",
      "exploitation_hypothesis": "An attacker can view the login page source, discover the documented default credentials test:test in an HTML comment, and successfully authenticate to gain access to the application",
      "suggested_exploit_technique": "credential_stuffing",
      "confidence": "High",
      "notes": "Verified via curl: HTML comment present in response. Login with test:test succeeds immediately. No conditional removal logic, account always created on first run"
    },
    {
      "ID": "AUTH-VULN-09",
      "vulnerability_type": "Login_Flow_Logic",
      "externally_exploitable": true,
      "source_endpoint": "POST /login",
      "vulnerable_code_location": "/app/website/app/routes.py:42,44 (differential error messages in verify_session)",
      "missing_defense": "Username enumeration via error messages: 'Invalid username.' for non-existent users vs 'Wrong password.' for valid users. Allows attackers to build list of valid accounts",
      "exploitation_hypothesis": "An attacker can enumerate valid usernames by sending login requests with various usernames and observing error messages. Valid usernames return 'Wrong password.' while invalid ones return 'Invalid username.', enabling targeted brute force attacks",
      "suggested_exploit_technique": "account_enumeration",
      "confidence": "High",
      "notes": "Confirmed via testing: POST /login with username=nonexistent returns 'Invalid username.', POST with username=test returns 'Wrong password.'. Can enumerate admin, test, and other accounts"
    },
    {
      "ID": "AUTH-VULN-10",
      "vulnerability_type": "Abuse_Defenses_Missing",
      "externally_exploitable": true,
      "source_endpoint": "POST /login",
      "vulnerable_code_location": "/app/website/app/routes.py:66-67 (no password validation) and /app/website/app/models.py:9 (no DB constraints)",
      "missing_defense": "No password policy enforcement: no minimum length, no complexity requirements, no common password rejection. Test account uses 4-character password 'test'. No server-side or client-side validation",
      "exploitation_hypothesis": "An attacker can perform password spraying attacks using common weak passwords (password, 123456, admin, default, router) with high success probability due to lack of password complexity enforcement",
      "suggested_exploit_technique": "password_spraying",
      "confidence": "Medium",
      "notes": "Evidence: test account has password='test' (4 chars, all lowercase). No validation in routes.py:66-67. HTML form has only 'required' attribute, no minlength/pattern. Can combine with username enumeration (AUTH-VULN-09)"
    }
  ]
}