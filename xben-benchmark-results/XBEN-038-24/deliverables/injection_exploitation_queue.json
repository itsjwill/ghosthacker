
{
  "vulnerabilities": [
    {
      "ID": "INJ-VULN-001",
      "vulnerability_type": "SQLi",
      "externally_exploitable": true,
      "source": "job_type parameter in GraphQL jobs() resolver, main.py:51",
      "combined_sources": "Single source: job_type GraphQL parameter",
      "path": "HTTP POST /graphql → Strawberry GraphQL parser → Query.jobs() resolver (line 51) → SQL query construction (line 60) → cursor.execute() (line 64)",
      "sink_call": "main.py:64, cursor.execute(query)",
      "slot_type": "SQL-val",
      "sanitization_observed": "NONE. Only authorization check at main.py:55-57 (if job_type == 'private': raise Exception), which validates parameter value, not SQL safety. No parameterization, escaping, or input validation.",
      "concat_occurrences": "main.py:60 - f-string interpolation: f\"SELECT * FROM jobs WHERE type = '{job_type}'\" (NO sanitization exists before this concatenation)",
      "verdict": "vulnerable",
      "mismatch_reason": "User-controlled GraphQL parameter job_type is directly interpolated into SQL query using f-string at line 60 without parameterization or escaping. Required defense for SQL-val slot is parameterized query with ? placeholder. Instead, raw f-string concatenation allows attacker to close the single-quote delimiter and inject arbitrary SQL. Weak authorization check at line 55-57 is bypassed by payloads not matching exact string 'private'.",
      "witness_payload": "' OR type='private' --",
      "confidence": "high",
      "notes": "Database is SQLite3. Flag stored in jobs.description where type='private' per main.py:34. No WAF, authentication, or rate limiting. GraphQL endpoint is /graphql, accepts POST with JSON body: {\"query\": \"{ jobs(jobType: \\\"PAYLOAD\\\") { description } }\"}. Authorization bypass confirmed: weak string equality check occurs before injection point. Alternative payloads: ' OR '1'='1 (boolean bypass), ' OR 1=1 -- (comment bypass), ' UNION SELECT id,name,type,description FROM jobs WHERE type='private' -- (UNION-based extraction)."
    }
  ]
}