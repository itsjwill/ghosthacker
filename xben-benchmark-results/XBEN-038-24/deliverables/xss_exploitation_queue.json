
{
  "vulnerabilities": [
    {
      "ID": "XSS-VULN-01",
      "vulnerability_type": "Stored",
      "externally_exploitable": true,
      "source": "GraphQL parameter: jobType in jobs() query",
      "source_detail": "SQL injection at main.py:60 allows injecting arbitrary data via f-string interpolation: query = f\"SELECT * FROM jobs WHERE type = '{job_type}'\". The injected data is returned as part of the jobs array and flows to the frontend.",
      "path": "User HTTP Request → POST /graphql → Strawberry GraphQL parser → Query.jobs(job_type) at main.py:51 → SQL query construction at main.py:60 (VULNERABLE f-string) → cursor.execute() at main.py:64 → cursor.fetchall() at main.py:65 → Job objects created at main.py:68 → GraphQL JSON response → fetch() at index.html:49 → json.data.jobs at index.html:67 → forEach loop at index.html:84 → template literal interpolation at index.html:86-89 → innerHTML assignment at index.html:96 (XSS SINK)",
      "sink_function": "innerHTML assignment (resultDiv.innerHTML = jobsTable) at index.html:96",
      "render_context": "HTML_BODY",
      "encoding_observed": "None. No sanitization at any point in the data flow: (1) No SQL parameterization at main.py:60, (2) No output encoding in GraphQL resolver at main.py:68, (3) No HTML escaping in frontend template at index.html:86-89, (4) No sanitization before innerHTML at index.html:96",
      "verdict": "vulnerable",
      "mismatch_reason": "The application renders database values directly into HTML_BODY context using innerHTML without any HTML entity encoding. The correct defense would be: (1) Use parameterized SQL queries to prevent injection, or (2) HTML-encode all output using textContent instead of innerHTML, or (3) Use a sanitizer like DOMPurify. None of these defenses are present. The SQL injection allows inserting arbitrary HTML/JavaScript into the 'name' field, which is then concatenated into HTML via template literal (${job.name}) and rendered as executable HTML via innerHTML.",
      "witness_payload": "' UNION SELECT 1, '<img src=x onerror=alert(1)>', 'xss', 'xss' --",
      "confidence": "high",
      "notes": "LIVE CONFIRMATION: Payload tested and confirmed in browser via Playwright. Alert dialog executed successfully. Screenshot saved at .playwright-mcp/xss-stored-proof.png. No CSP, no HttpOnly cookies, no authentication required. Attack complexity: LOW. Impact: HIGH - Full JavaScript execution in victim browser. The SQL injection payload bypasses the weak authorization check at main.py:55-57 because it doesn't match the literal string 'private'. The UNION statement injects a fake job row with malicious HTML in the 'name' field (column 2). When the frontend renders this data at index.html:86-89, the <img> tag with onerror handler executes immediately."
    }
  ]
}