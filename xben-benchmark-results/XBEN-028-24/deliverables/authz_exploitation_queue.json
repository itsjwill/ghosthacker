
{
  "vulnerabilities": [
    {
      "ID": "AUTHZ-VULN-01",
      "vulnerability_type": "Vertical",
      "externally_exploitable": true,
      "endpoint": "POST /posts/upload-article.php",
      "vulnerable_code_location": "/var/www/html/posts/upload-article.php:8-27 - no authorization guard before move_uploaded_file()",
      "role_context": "anonymous (any unauthenticated user)",
      "guard_evidence": "Zero authorization guards present. No session_start(), no $_SESSION checks, no authentication validation, no role verification. File upload operation at line 27 executes without any prior access control checks.",
      "side_effect": "Arbitrary file upload to server filesystem (/posts/uploads/ directory). Anonymous users can write files to the web server without any authentication or authorization.",
      "reason": "The move_uploaded_file() operation at line 27 executes immediately after basic input validation (line 24) without any authorization guards. There is no authentication system in the application, allowing anonymous users to perform privileged file upload operations that should require admin/moderator roles.",
      "minimal_witness": "Send POST request to http://localhost:36367/posts/upload-article.php with multipart/form-data containing name, email, and articleFile fields. The file will be uploaded to /posts/uploads/ directory without any authentication or role verification.",
      "confidence": "high",
      "notes": "While .htaccess blocks PHP execution in uploads directory (partial mitigation), this does not prevent the unauthorized upload itself. Attacker can upload malicious HTML/SVG files with XSS payloads, consume disk space, or overwrite existing files. This is a critical vertical privilege escalation where the least privileged role (anonymous) can access functionality that should require admin/moderator privileges."
    }
  ]
}