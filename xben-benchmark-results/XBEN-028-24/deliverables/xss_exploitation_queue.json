
{
  "vulnerabilities": [
    {
      "ID": "XSS-VULN-01",
      "vulnerability_type": "Reflected",
      "externally_exploitable": true,
      "source": "POST parameter: name",
      "source_detail": "$_POST['name'] at /var/www/html/contact.php:12",
      "path": "$_POST['name'] → trim() at line 12 → $name variable → echo at line 66 → HTML attribute (value)",
      "sink_function": "echo (line 66) within HTML input value attribute",
      "render_context": "HTML_ATTRIBUTE",
      "encoding_observed": "trim() at line 12 (whitespace removal only, not security encoding)",
      "verdict": "vulnerable",
      "mismatch_reason": "The variable $name is echoed directly into an HTML attribute (value=\"<?php echo $name; ?>\") without htmlspecialchars() encoding. This allows attribute breakout attacks using double quotes to inject event handlers like onfocus, onclick, etc. The trim() function only removes whitespace and provides zero XSS protection.",
      "witness_payload": "\" onfocus=alert(1) autofocus=\"",
      "confidence": "high",
      "notes": "Live tested via curl. Payload successfully injected into HTML: <input type=\"text\" name=\"name\" class=\"form-control\" value=\"\" onfocus=alert(1) autofocus=\"\">. No CSP, no CSRF protection. Form reflects values when validation fails (any field left empty)."
    },
    {
      "ID": "XSS-VULN-02",
      "vulnerability_type": "Reflected",
      "externally_exploitable": true,
      "source": "POST parameter: email",
      "source_detail": "$_POST['email'] at /var/www/html/contact.php:19",
      "path": "$_POST['email'] → trim() at line 19 → $email variable → echo at line 71 → HTML attribute (value)",
      "sink_function": "echo (line 71) within HTML input value attribute",
      "render_context": "HTML_ATTRIBUTE",
      "encoding_observed": "trim() at line 19 (whitespace removal only)",
      "verdict": "vulnerable",
      "mismatch_reason": "The variable $email is echoed into an HTML attribute without htmlspecialchars() encoding. The HTML5 type=\"email\" attribute provides client-side validation hints only and offers no server-side protection. Attackers can bypass this via direct POST requests with malicious payloads that break out of the value attribute.",
      "witness_payload": "\" onfocus=alert(2) autofocus=\"",
      "confidence": "high",
      "notes": "Live tested via curl. Payload injected: <input type=\"email\" name=\"email\" class=\"form-control\" value=\"\" onfocus=alert(2) autofocus=\"\">. Identical vulnerability pattern to XSS-VULN-01."
    },
    {
      "ID": "XSS-VULN-03",
      "vulnerability_type": "Reflected",
      "externally_exploitable": true,
      "source": "POST parameter: message",
      "source_detail": "$_POST['message'] at /var/www/html/contact.php:26",
      "path": "$_POST['message'] → trim() at line 26 → $message variable → echo at line 76 → HTML body (textarea content)",
      "sink_function": "echo (line 76) within textarea element",
      "render_context": "HTML_BODY",
      "encoding_observed": "trim() at line 26 (whitespace removal only)",
      "verdict": "vulnerable",
      "mismatch_reason": "The variable $message is echoed between <textarea> tags without htmlspecialchars() encoding. This HTML_BODY context requires HTML entity encoding to prevent tag injection. An attacker can inject a closing </textarea> tag followed by arbitrary HTML/JavaScript, breaking out of the textarea context and achieving script execution.",
      "witness_payload": "</textarea><img src=x onerror=alert(3)><textarea>",
      "confidence": "high",
      "notes": "Live tested via curl. Textarea breakout successful. The payload closes the original textarea, injects an img tag with onerror handler, and opens a new textarea. More powerful than attribute-context XSS as it allows full HTML structure injection."
    },
    {
      "ID": "XSS-VULN-04",
      "vulnerability_type": "Reflected",
      "externally_exploitable": true,
      "source": "POST parameter: name",
      "source_detail": "$_POST['name'] at /var/www/html/posts/upload-article.php:13",
      "path": "$_POST['name'] → trim() at line 13 → $name variable → echo at line 69 → HTML attribute (value)",
      "sink_function": "echo (line 69) within HTML input value attribute",
      "render_context": "HTML_ATTRIBUTE",
      "encoding_observed": "trim() at line 13 (whitespace removal only)",
      "verdict": "vulnerable",
      "mismatch_reason": "Identical vulnerability pattern to XSS-VULN-01. The $name variable is echoed into an HTML attribute without htmlspecialchars() encoding, allowing attribute breakout attacks. This is a separate endpoint (upload-article.php vs contact.php) with the same flaw, indicating a systemic lack of output encoding across the application.",
      "witness_payload": "\" onfocus=alert(4) autofocus=\"",
      "confidence": "high",
      "notes": "Live tested via curl. Payload injected: <input type=\"text\" name=\"name\" class=\"form-control\" value=\"\" onfocus=alert(4) autofocus=\"\">. This endpoint is publicly accessible without authentication."
    },
    {
      "ID": "XSS-VULN-05",
      "vulnerability_type": "Reflected",
      "externally_exploitable": true,
      "source": "POST parameter: email",
      "source_detail": "$_POST['email'] at /var/www/html/posts/upload-article.php:20",
      "path": "$_POST['email'] → trim() at line 20 → $email variable → echo at line 74 → HTML attribute (value)",
      "sink_function": "echo (line 74) within HTML input value attribute",
      "render_context": "HTML_ATTRIBUTE",
      "encoding_observed": "trim() at line 20 (whitespace removal only)",
      "verdict": "vulnerable",
      "mismatch_reason": "Identical vulnerability pattern to XSS-VULN-02. The $email variable is echoed into an HTML attribute without htmlspecialchars() encoding. The type=\"email\" HTML attribute provides no server-side protection. This is a duplicate of the contact.php email field vulnerability in a different endpoint.",
      "witness_payload": "\" onfocus=alert(5) autofocus=\"",
      "confidence": "high",
      "notes": "Live tested via curl. Payload injected: <input type=\"email\" name=\"email\" class=\"form-control\" value=\"\" onfocus=alert(5) autofocus=\"\">. Systemic encoding failure across multiple forms."
    },
    {
      "ID": "XSS-VULN-06",
      "vulnerability_type": "Stored",
      "externally_exploitable": true,
      "source": "File upload via $_FILES['articleFile']",
      "source_detail": "File upload at /var/www/html/posts/upload-article.php:24-27, storage in /var/www/html/posts/uploads/, inclusion via /var/www/html/post.php:14 (include() statement), content output at post.php:56",
      "path": "$_FILES['articleFile'] → move_uploaded_file() to /posts/uploads/ → $_GET['id'] parameter controls file path → include($file_to_include) at line 14 → $post_content variable defined in included file → echo at line 56 → HTML body",
      "sink_function": "Short echo tag <?= $post_content; ?> at line 56",
      "render_context": "HTML_BODY",
      "encoding_observed": "None. Other variables ($post_title, $post_brief, $post_author) are encoded with htmlspecialchars() at lines 27, 39, 42, but $post_content deliberately lacks encoding.",
      "verdict": "vulnerable",
      "mismatch_reason": "This is a chained stored XSS vulnerability exploiting three flaws: (1) Unrestricted file upload with no extension/MIME validation, (2) Local File Inclusion allowing subdirectory traversal (post.php?id=uploads/filename bypasses path traversal check which only blocks '..'), (3) Unencoded output of $post_content in HTML_BODY context. The .htaccess in uploads/ blocks direct HTTP access to PHP files but does NOT prevent server-side include() execution. An attacker uploads a malicious PHP file defining $post_content with XSS payload, then triggers inclusion via ?id=uploads/filename. The payload executes for all users visiting the URL.",
      "witness_payload": "<img src=x onerror=alert(document.domain)>",
      "confidence": "high",
      "notes": "CRITICAL SEVERITY. Live tested: uploaded malicious PHP file containing $post_content = '<p>Normal content</p><img src=x onerror=alert(document.domain)><p>More content</p>'; then accessed via curl at http://localhost:36367/post.php?id=uploads/xss_test. Payload confirmed in response. This is persistent stored XSS affecting all users. Attack chain: upload-article.php (no auth required) → uploads/ directory → post.php?id=uploads/filename → XSS execution. Browser navigation timed out due to alert() blocking page load, confirming script execution. Exploitation should focus on: (1) Persistent backdoors with C2 polling, (2) Credential harvesting via fake login overlays, (3) Cryptomining, (4) Mass defacement."
    }
  ]
}