# Cross-Site Scripting (XSS) Exploitation Evidence

## Successfully Exploited Vulnerabilities

### XSS-VULN-01: Reflected XSS in Contact Form - Name Field

**Summary:**
- **Vulnerable location:** http://localhost:45447/contact.php - POST parameter `name`
- **Overview:** Attribute injection vulnerability in the contact form's name field allowing arbitrary JavaScript execution through event handler injection
- **Impact:** Complete client-side compromise - attacker can execute arbitrary JavaScript in victim's browser context, enabling DOM manipulation, credential phishing, keystroke logging, and page defacement
- **Severity:** High

**Prerequisites:**
- None - vulnerability is accessible to unauthenticated users on the public interface

**Exploitation Steps:**

1. Navigate to the contact form at http://localhost:45447/contact.php

2. Submit the form with the following payload in the name field, leaving email empty to trigger validation error:

```bash
curl -X POST http://localhost:45447/contact.php \
  -d 'name=" onfocus="alert(1)" autofocus="&email=&message=test'
```

3. The server returns the contact form with the name field containing the injected payload:
```html
<input type="text" name="name" class="form-control" value="" onfocus="alert(1)" autofocus="">
```

4. The `autofocus` attribute causes the name field to immediately gain focus, triggering the `onfocus` event handler which executes `alert(1)`

**Proof of Impact:**
- JavaScript execution confirmed: Alert dialog with message "1" displayed
- Browser automatically focuses the field due to `autofocus` attribute
- The `onfocus` event handler executes arbitrary JavaScript code
- No Content Security Policy (CSP) prevents inline event handlers
- Payload successfully breaks out of the `value` attribute by injecting a double-quote

**Technical Details:**
- Vulnerable code location: `/app/website/contact.php:66`
- Missing sanitization: `htmlspecialchars()` with `ENT_QUOTES` flag not applied
- Render context: HTML_ATTRIBUTE (input value)
- Data flow: `$_POST['name']` → `trim()` only → `echo` without encoding

---

### XSS-VULN-02: Reflected XSS in Contact Form - Email Field

**Summary:**
- **Vulnerable location:** http://localhost:45447/contact.php - POST parameter `email`
- **Overview:** Attribute injection vulnerability in the contact form's email field, identical to name field but with additional issue of missing server-side email format validation
- **Impact:** Complete client-side compromise with arbitrary JavaScript execution capability
- **Severity:** High

**Prerequisites:**
- None - vulnerability is accessible to unauthenticated users on the public interface

**Exploitation Steps:**

1. Navigate to the contact form at http://localhost:45447/contact.php

2. Submit the form with the following payload in the email field, leaving name empty to trigger validation error:

```bash
curl -X POST http://localhost:45447/contact.php \
  -d 'name=&email=" onfocus="alert(2)" autofocus="&message=test'
```

3. The server returns the contact form with the email field containing the injected payload:
```html
<input type="email" name="email" class="form-control" value="" onfocus="alert(2)" autofocus="">
```

4. The `autofocus` attribute causes the email field to gain focus, triggering the `onfocus` event handler which executes `alert(2)`

**Proof of Impact:**
- JavaScript execution confirmed: Alert dialog with message "2" displayed
- Email field gains focus automatically and executes the injected code
- Despite HTML5 `type="email"` attribute, server performs NO email format validation
- Any string (including XSS payloads) is accepted as valid email input
- Successful attribute breakout via double-quote injection

**Technical Details:**
- Vulnerable code location: `/app/website/contact.php:71`
- Missing sanitization: `htmlspecialchars()` with `ENT_QUOTES` flag not applied
- Missing validation: No server-side email format check (no `filter_var($email, FILTER_VALIDATE_EMAIL)`)
- Render context: HTML_ATTRIBUTE (input value)
- Data flow: `$_POST['email']` → `trim()` only → `echo` without encoding

---

### XSS-VULN-03: Reflected XSS in Contact Form - Message Field

**Summary:**
- **Vulnerable location:** http://localhost:45447/contact.php - POST parameter `message`
- **Overview:** Tag injection vulnerability in the message textarea field allowing direct script tag injection
- **Impact:** Complete client-side compromise - this is the most straightforward of the three vectors as it allows direct `<script>` tag injection rather than requiring event handler attributes
- **Severity:** High

**Prerequisites:**
- None - vulnerability is accessible to unauthenticated users on the public interface

**Exploitation Steps:**

1. Navigate to the contact form at http://localhost:45447/contact.php

2. Submit the form with the following payload in the message field, leaving name empty to trigger validation error:

```bash
curl -X POST http://localhost:45447/contact.php \
  -d 'name=&email=test@example.com&message=</textarea><script>alert(3)</script>'
```

3. The server returns the contact form with the message field prematurely closed and script tag injected:
```html
<textarea name="message" class="form-control"></textarea><script>alert(3)</script></textarea>
```

4. The browser parses the HTML and executes the `<script>alert(3)</script>` tag immediately

**Proof of Impact:**
- JavaScript execution confirmed: Alert dialog with message "3" displayed
- Direct script tag injection achieved by closing the textarea tag prematurely
- No CSP restrictions prevent inline script execution
- This vector is simpler than attribute injection as it doesn't require event handlers

**Technical Details:**
- Vulnerable code location: `/app/website/contact.php:76`
- Missing sanitization: `htmlspecialchars()` not applied
- Render context: HTML_BODY (textarea content)
- Data flow: `$_POST['message']` → `trim()` only → `echo` without encoding
- Attack vector: Textarea tag breakout via `</textarea>` followed by arbitrary HTML/JavaScript

**Notes:**
All three XSS vulnerabilities share the same root cause: the application only applies `trim()` for validation but completely omits output encoding with `htmlspecialchars()`. The contact form represents a consistent pattern of missing security controls across all user input fields.

**Exploitation Impact Beyond Alert:**
While the proof-of-concept demonstrates JavaScript execution via `alert()`, these vulnerabilities enable significantly more harmful attacks:

- **Credential Phishing:** Inject fake login forms to harvest usernames/passwords
- **DOM Manipulation:** Deface the page or inject misleading content
- **Keystroke Logging:** Capture all user input on the page
- **Redirection Attacks:** Redirect victims to malicious sites
- **Cross-Site Request Forgery (CSRF):** Perform unauthorized actions via XSS
- **Information Disclosure:** Extract sensitive data from the DOM or application state

**Environmental Factors:**
- No Content Security Policy (CSP) header present
- No HTTP security headers (X-Frame-Options, X-XSS-Protection)
- No CSRF protection on contact form
- Application has no session management (no cookies to steal via traditional session hijacking)