
{
  "vulnerabilities": [
    {
      "ID": "XSS-VULN-01",
      "vulnerability_type": "Stored",
      "externally_exploitable": true,
      "source": "POST parameter: job_type in /jobs endpoint",
      "source_detail": "SQL injection at main.py:53 allows injection into query results. User input: req.body.job_type → f-string interpolation: f\"SELECT * FROM jobs WHERE type = '{job_type}'\" → cursor.execute(query) at main.py:57",
      "path": "POST /jobs {job_type} → main.py:42 data.get('job_type') → main.py:49-50 weak filter (bypassed with nested keywords) → main.py:53 f-string SQL query → main.py:57 cursor.execute() → main.py:58 cursor.fetchall() → main.py:60-61 JSON response (no HTML encoding) → index.html:47 response.json() → index.html:63-71 template literal ${user.description} → index.html:74 innerHTML assignment → DOM rendering",
      "sink_function": "innerHTML assignment at index.html:74: resultDiv.innerHTML = jobsTable",
      "render_context": "HTML_BODY",
      "encoding_observed": "None. The complete data flow from database to DOM has zero HTML encoding: (1) cursor.fetchall() returns raw data, (2) FastAPI JSON serialization at main.py:60-61 uses JSON encoding only (escapes quotes/backslashes, not HTML chars), (3) Client-side template literal at index.html:63-71 performs direct string interpolation without encoding, (4) innerHTML renders the string as HTML",
      "verdict": "vulnerable",
      "mismatch_reason": "The render context is HTML_BODY (via innerHTML DOM manipulation) which requires HTML entity encoding to convert special characters: < → &lt;, > → &gt;, & → &amp;, \" → &quot;, ' → &#x27;. However, the application performs NO output encoding at any stage. JSON serialization only escapes characters for JSON validity (quotes and backslashes) but does NOT encode HTML special characters. This allows an attacker to inject arbitrary HTML/JavaScript via SQL injection, which executes when rendered by innerHTML. The vulnerability chain: SQL Injection → Arbitrary database response content → Unencoded JSON → Direct DOM insertion → Script execution.",
      "witness_payload": "' UNUNIONION SELSELECTECT 999,'XSSTest','xss','<details open ontoggle=alert(document.domain)>XSS</details>' as description--",
      "confidence": "high",
      "notes": "CRITICAL CHAIN VULNERABILITY: This is a Stored XSS delivered via SQL Injection. The application has no authentication, no session cookies (no HttpOnly flags to bypass), and no Content Security Policy. SQL injection filter at main.py:49-50 removes keywords including 'OR'/'or', which affects XSS payloads containing 'onerror' (becomes 'onerr'). Bypass: Use nested keywords for SQL (UNUNIONION→UNION) and event handlers without 'or' for XSS (ontoggle, onload, onfocus, onmouseover). Successfully tested payload with <details ontoggle=alert()> confirmed JavaScript execution in live browser (Playwright). Attack is externally exploitable via public HTTP endpoint with no authentication required. Proof-of-concept screenshot: deliverables/xss_proof_of_concept.png. The vulnerability exists at TWO layers: (1) SQL injection allows query result manipulation, (2) innerHTML rendering without sanitization executes injected scripts. Both vulnerabilities must exist for exploitation; fixing either breaks the chain."
    }
  ]
}