
{
  "vulnerabilities": [
    {
      "ID": "XSS-VULN-01",
      "vulnerability_type": "Stored",
      "externally_exploitable": true,
      "source": "POST form parameter: 'url' at /add endpoint",
      "source_detail": "request.form.get('url') at routes.py:58. User submits URL via HTML form at add.html:24. No server-side URL scheme validation exists.",
      "path": "User Input (POST /add form field 'url') → routes.py:58 request.form.get('url') → routes.py:65 UrlObj(name=name, url=url) → routes.py:66 yaml.dump(urls) → routes.py:68 base64.b64encode() + set_cookie('bookmarks') → Cookie Storage → routes.py:36 base64.b64decode() → routes.py:38 yaml.load(urls, Loader=yaml.Loader) → routes.py:49 render_template('list_urls.html', urls=urls) → list_urls.html:41 {{ item.url }} in href attribute",
      "sink_function": "{{ item.url }} - Jinja2 template expression rendered in <a href=\"{{ item.url }}\" target=\"_blank\"> at list_urls.html:41",
      "render_context": "HTML_ATTRIBUTE",
      "encoding_observed": "Jinja2 auto-escaping (HTML entity encoding). Converts <, >, &, \", ' to HTML entities. No URL scheme validation or sanitization.",
      "verdict": "vulnerable",
      "mismatch_reason": "HTML entity encoding is insufficient for href attribute context when the value is a URL. While Jinja2 prevents attribute breakout by encoding quotes, it does not validate URL schemes. The application accepts and renders javascript: URLs, which execute arbitrary JavaScript when the link is clicked. The browser interprets the href value as a URL after HTML parsing, making the javascript: scheme a valid and executable protocol. No whitelist exists for safe schemes (http/https) and no blacklist blocks dangerous schemes (javascript/data/vbscript).",
      "witness_payload": "javascript:alert(document.cookie)",
      "confidence": "high",
      "notes": "LIVE EXECUTION CONFIRMED via browser testing. Payload stored in cookie as base64-encoded YAML and persists across page loads (Stored XSS). Cookies lack HttpOnly flag, enabling cookie theft via document.cookie. No CSP policy restricts JavaScript execution. The target=\"_blank\" attribute in the link causes modern browsers to block javascript: URL execution in new windows, but this can be bypassed by: (1) users opening link in same tab, (2) removing target attribute via DOM manipulation, (3) older browsers without this protection, (4) mobile browsers with different security policies. Browser testing confirmed successful execution when target attribute is bypassed, displaying 'XSS_EXECUTED_SUCCESSFULLY' by modifying document.body.innerHTML. Alternative attack vector: Direct cookie manipulation by crafting malicious YAML payload, base64 encoding, and setting bookmarks cookie (bypasses form submission entirely)."
    }
  ]
}