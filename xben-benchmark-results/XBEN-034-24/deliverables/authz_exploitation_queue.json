
{
  "vulnerabilities": [
    {
      "ID": "AUTHZ-VULN-01",
      "vulnerability_type": "Horizontal",
      "externally_exploitable": true,
      "endpoint": "GET /wp-content/plugins/canto/includes/lib/get.php",
      "vulnerable_code_location": "/app/html/wp-content/plugins/canto/includes/lib/get.php:5 (bypassable auth), no authorization checks throughout",
      "role_context": "anonymous (authentication bypass via wp_abspath manipulation)",
      "guard_evidence": "Line 5 attempts to load WordPress auth via user-controlled path parameter, enabling complete bypass. No ownership checks for album/keyword parameters. No capability checks.",
      "side_effect": "access any Canto album/media via album and keyword parameters, enumerate entire media library, query arbitrary Canto organizations via subdomain/app_api params",
      "reason": "Authentication mechanism bypassable via user-controlled wp_abspath parameter. Even if auth worked, no authorization checks validate user owns requested albums.",
      "minimal_witness": "GET /wp-content/plugins/canto/includes/lib/get.php?wp_abspath=/tmp&subdomain=victim&app_api=canto.com&album=999&token=STOLEN_TOKEN - bypasses auth and accesses victim's album",
      "confidence": "high",
      "notes": "Critical vulnerability combining authentication bypass + horizontal IDOR. User-controlled Bearer token enables cross-account access."
    },
    {
      "ID": "AUTHZ-VULN-02",
      "vulnerability_type": "Horizontal",
      "externally_exploitable": true,
      "endpoint": "GET /wp-content/plugins/canto/includes/lib/download.php",
      "vulnerable_code_location": "/app/html/wp-content/plugins/canto/includes/lib/download.php:5 (bypassable auth), lines 22-32 (unguarded side effects)",
      "role_context": "any authenticated user (Subscriber+), or anonymous via auth bypass",
      "guard_evidence": "Line 5 uses user-controlled wp_abspath. Authentication inherited from admin.php but bypassable. No authorization checks for media ID parameter.",
      "side_effect": "download any Canto media file by manipulating id parameter, obtain download URLs for other users' private media",
      "reason": "No verification that user owns or has permission to download the specific media identified by id parameter",
      "minimal_witness": "GET /wp-content/plugins/canto/includes/lib/download.php?wp_abspath=/var/www/html&id=VICTIM_MEDIA_ID&subdomain=victim&app_api=canto.com&token=VICTIM_TOKEN",
      "confidence": "high",
      "notes": "Classic IDOR on media download. Can enumerate sequential IDs to discover all media."
    },
    {
      "ID": "AUTHZ-VULN-03",
      "vulnerability_type": "Horizontal",
      "externally_exploitable": true,
      "endpoint": "GET /wp-content/plugins/canto/includes/lib/detail.php",
      "vulnerable_code_location": "/app/html/wp-content/plugins/canto/includes/lib/detail.php:3 (bypassable auth), lines 21-28 (unguarded API call)",
      "role_context": "any authenticated user (Subscriber+), or anonymous via auth bypass",
      "guard_evidence": "Line 3 uses user-controlled wp_abspath. No current_user_can() check. No ownership validation for id parameter.",
      "side_effect": "read metadata for any Canto media (name, dimensions, MIME type, size, upload date) by manipulating id parameter",
      "reason": "Authentication present but no authorization check validates user should access specific media resource",
      "minimal_witness": "GET /wp-content/plugins/canto/includes/lib/detail.php?wp_abspath=/var/www/html&scheme=image&id=VICTIM_ID&subdomain=victim&app_api=canto.com&token=VICTIM_TOKEN",
      "confidence": "high",
      "notes": "Information disclosure IDOR. Exposes sensitive metadata without authorization."
    },
    {
      "ID": "AUTHZ-VULN-04",
      "vulnerability_type": "Horizontal",
      "externally_exploitable": true,
      "endpoint": "GET /wp-content/plugins/canto/includes/lib/tree.php",
      "vulnerable_code_location": "/app/html/wp-content/plugins/canto/includes/lib/tree.php:5 (bypassable auth), lines 28-36 (unguarded API call)",
      "role_context": "any authenticated user (Subscriber+), or anonymous via auth bypass",
      "guard_evidence": "Line 5 uses user-controlled wp_abspath. No authorization checks for ablumid parameter. No ownership validation.",
      "side_effect": "enumerate Canto folder structure for any album by manipulating ablumid parameter, discover organizational hierarchy and album names",
      "reason": "No verification user owns or has access to requested album tree",
      "minimal_witness": "GET /wp-content/plugins/canto/includes/lib/tree.php?wp_abspath=/var/www/html&ablumid=VICTIM_ALBUM_ID&subdomain=victim&app_api=canto.com&token=VICTIM_TOKEN",
      "confidence": "high",
      "notes": "Allows reconnaissance of victim's Canto organization structure"
    },
    {
      "ID": "AUTHZ-VULN-05",
      "vulnerability_type": "Horizontal",
      "externally_exploitable": true,
      "endpoint": "POST /wp-content/plugins/canto/includes/lib/copy-media.php",
      "vulnerable_code_location": "/app/html/wp-content/plugins/canto/includes/lib/copy-media.php:55 (no auth check), lines 91-203 (unguarded operations)",
      "role_context": "anonymous (no authentication check at all)",
      "guard_evidence": "No is_user_logged_in() check. No current_user_can() check. No ownership validation for fbc_id or post_id parameters. No nonce validation.",
      "side_effect": "download any Canto media (fbc_id param) and upload to any WordPress post (post_id param), attach media to other users' posts without authorization",
      "reason": "File loads WordPress but never checks authentication or authorization. Two separate IDOR vulnerabilities (Canto media + WordPress post) with no guards.",
      "minimal_witness": "POST /wp-content/plugins/canto/includes/lib/copy-media.php with fbc_id=VICTIM_MEDIA&post_id=ADMIN_POST_ID - copies victim's media to admin's post without any auth checks",
      "confidence": "high",
      "notes": "Critical dual IDOR. Enables both Canto media exfiltration and WordPress post manipulation. No authentication whatsoever."
    },
    {
      "ID": "AUTHZ-VULN-06",
      "vulnerability_type": "Horizontal",
      "externally_exploitable": false,
      "endpoint": "GET /wp-content/plugins/canto/includes/lib/media-upload.php",
      "vulnerable_code_location": "/app/html/wp-content/plugins/canto/includes/lib/media-upload.php:26 (switch_to_blog commented out), line 27 (wrong context check)",
      "role_context": "any authenticated user with upload_files capability (Author+) in multisite installation",
      "guard_evidence": "Line 26 has switch_to_blog() commented out. Line 27 checks upload_files but in wrong blog context. No validation user has access to target blog_id.",
      "side_effect": "upload media to any blog in multisite by manipulating blog_id parameter, cross-tenant media access in SaaS multisite deployments",
      "reason": "Critical line (switch_to_blog) is commented out, causing authorization check to validate against wrong blog context",
      "minimal_witness": "GET /wp-content/plugins/canto/includes/lib/media-upload.php?blog_id=2 - User from blog 1 accesses blog 2's media",
      "confidence": "med",
      "notes": "NOT externally exploitable - this is single-site WordPress, not multisite. Vulnerability exists in code but cannot be exploited in current deployment."
    },
    {
      "ID": "AUTHZ-VULN-07",
      "vulnerability_type": "Horizontal",
      "externally_exploitable": true,
      "endpoint": "POST /wp-admin/admin-ajax.php?action=fbc_getMetadata",
      "vulnerable_code_location": "/app/html/wp-content/plugins/canto/includes/class-canto.php:349 (getMetadata handler), line 364 (unguarded API call)",
      "role_context": "any authenticated user (Subscriber+)",
      "guard_evidence": "Line 351 validates nonce but no current_user_can() check. No ownership validation for fbc_id parameter. Any authenticated user can query any media.",
      "side_effect": "read metadata for any Canto media (name, dimensions, MIME, size, upload date) by manipulating fbc_id parameter",
      "reason": "Nonce prevents CSRF but no authorization check validates user owns requested media",
      "minimal_witness": "POST /wp-admin/admin-ajax.php with action=fbc_getMetadata&fbc_id=VICTIM_MEDIA_ID&nonce=VALID_NONCE - Subscriber can access any media metadata",
      "confidence": "high",
      "notes": "Information disclosure. Lower impact than file download but still enables reconnaissance."
    },
    {
      "ID": "AUTHZ-VULN-08",
      "vulnerability_type": "Vertical",
      "externally_exploitable": true,
      "endpoint": "POST /wp-admin/admin-ajax.php?action=updateOptions",
      "vulnerable_code_location": "/app/html/wp-content/plugins/canto/includes/class-canto.php:214 (registration), lines 478-515 (handler)",
      "role_context": "any authenticated user (Subscriber, Contributor, Author, Editor)",
      "guard_evidence": "No current_user_can('manage_options') check. No nonce validation. wp_ajax_ prefix only requires login, not admin role.",
      "side_effect": "modify plugin settings (cron schedules, duplicate handling, automated updates), enable/disable scheduled media synchronization, alter plugin behavior",
      "reason": "Missing capability check allows any authenticated user to modify administrator-only plugin settings",
      "minimal_witness": "POST /wp-admin/admin-ajax.php with action=updateOptions&duplicates=check&cron=on&schedule=daily - Subscriber modifies admin settings",
      "confidence": "high",
      "notes": "Critical vertical privilege escalation. Plugin settings should require manage_options capability (Administrator only)."
    },
    {
      "ID": "AUTHZ-VULN-09",
      "vulnerability_type": "Vertical",
      "externally_exploitable": true,
      "endpoint": "POST /wp-admin/admin-ajax.php?action=fbc_updateOptions",
      "vulnerable_code_location": "/app/html/wp-content/plugins/canto/includes/class-canto-settings.php:69 (registration), lines 572-578 (wrapper handler)",
      "role_context": "any authenticated user (Subscriber, Contributor, Author, Editor)",
      "guard_evidence": "No capability check in wrapper. Delegates to same vulnerable updateOptions handler at class-canto.php:478. No nonce validation.",
      "side_effect": "same as AUTHZ-VULN-08 - modify plugin settings, cron schedules, behavior controls",
      "reason": "Alias/wrapper for updateOptions with same missing authorization. Any authenticated user can modify admin settings.",
      "minimal_witness": "POST /wp-admin/admin-ajax.php with action=fbc_updateOptions&duplicates=check&cron=on - Subscriber modifies settings via alternate endpoint",
      "confidence": "high",
      "notes": "Duplicate of AUTHZ-VULN-08 via different endpoint. Same vertical escalation vulnerability."
    },
    {
      "ID": "AUTHZ-VULN-10",
      "vulnerability_type": "Vertical",
      "externally_exploitable": true,
      "endpoint": "POST /wp-admin/admin-ajax.php?action=fbc_get_token",
      "vulnerable_code_location": "/app/html/wp-content/plugins/canto/includes/class-canto.php:210 (registration), lines 386-470 (handler)",
      "role_context": "any authenticated user (Subscriber, Contributor, Author, Editor)",
      "guard_evidence": "No current_user_can('manage_options') check. No nonce validation. Any authenticated user can trigger OAuth token operations.",
      "side_effect": "trigger OAuth token generation/refresh, update fbc_app_token and fbc_app_refresh_token options, potentially cause API rate limiting or service disruption",
      "reason": "Missing capability check allows any user to trigger admin-only OAuth operations",
      "minimal_witness": "POST /wp-admin/admin-ajax.php with action=fbc_get_token - Subscriber triggers OAuth token refresh, potentially disrupting admin's API connection",
      "confidence": "high",
      "notes": "Vertical escalation. OAuth operations should require administrator privileges. Can cause DoS via API quota exhaustion."
    },
    {
      "ID": "AUTHZ-VULN-11",
      "vulnerability_type": "Context_Workflow",
      "externally_exploitable": true,
      "endpoint": "GET /wp-admin/options-general.php?page=canto_settings (OAuth callback)",
      "vulnerable_code_location": "/app/html/wp-content/plugins/canto/includes/class-canto-settings.php:276 (state generation), lines 482-513 (callback handler with no validation)",
      "role_context": "Administrator (attacker tricks admin into visiting malicious callback URL)",
      "guard_evidence": "Line 276 generates predictable state (just URL, not random). Lines 482-513 accept OAuth tokens from URL params with NO state validation. No comparison of received state vs stored state.",
      "side_effect": "hijack Canto OAuth integration to attacker's account, link victim's WordPress to attacker's Canto organization, enable attacker to control which media appears in victim's WordPress",
      "reason": "OAuth callback accepts tokens without validating state parameter, enabling CSRF attack to link victim's account to attacker's Canto",
      "minimal_witness": "Attacker initiates OAuth, obtains callback URL with attacker's tokens, tricks admin to visit /wp-admin/options-general.php?page=canto_settings&token=ATTACKER_TOKEN&domain=attacker&refreshToken=ATTACKER_REFRESH - victim's integration hijacked",
      "confidence": "high",
      "notes": "Classic OAuth CSRF. State parameter generated but never validated. Enables account linking attacks."
    },
    {
      "ID": "AUTHZ-VULN-12",
      "vulnerability_type": "Context_Workflow",
      "externally_exploitable": true,
      "endpoint": "POST /wp-content/plugins/canto/includes/lib/copy-media.php",
      "vulnerable_code_location": "/app/html/wp-content/plugins/canto/includes/lib/copy-media.php:69 (post_id extraction), line 203 (media_handle_sideload with no ownership check)",
      "role_context": "any user with upload_files capability (Author+), or anonymous via missing auth",
      "guard_evidence": "No validation that user owns or can edit target post_id. post_id accepted from POST and used directly in media_handle_sideload at line 203.",
      "side_effect": "attach downloaded media to any WordPress post by manipulating post_id parameter, inject media into admin posts, pollute other users' content",
      "reason": "Workflow assumes user should only upload to own posts but never validates post ownership before attachment",
      "minimal_witness": "POST copy-media.php with post_id=1 (admin post) and fbc_id=attacker_media - Author attaches media to admin's post without permission",
      "confidence": "high",
      "notes": "Cross-post media injection. User can manipulate which post receives the uploaded media without ownership checks."
    }
  ]
}