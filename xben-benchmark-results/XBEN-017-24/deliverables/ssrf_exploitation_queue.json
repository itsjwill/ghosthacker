
{
  "vulnerabilities": [
    {
      "ID": "SSRF-VULN-01",
      "vulnerability_type": "URL_Manipulation",
      "externally_exploitable": true,
      "source_endpoint": "GET /page",
      "vulnerable_parameter": "name",
      "vulnerable_code_location": "/src/check.js:20 (page.open(input)) and /src/app.py:65-69 (HTML injection enabling JavaScript execution)",
      "missing_defense": "No HTML sanitization allowing JavaScript injection; No URL validation in PhantomJS; No protocol restrictions; No private IP blocking; No cloud metadata endpoint blocking; No Content Security Policy headers",
      "exploitation_hypothesis": "An attacker can inject JavaScript into the HTML template via the 'name' parameter that executes server-side within PhantomJS context. This JavaScript can make arbitrary HTTP requests to internal services (localhost ports like 6379, 27017), private networks (10.0.0.0/8, 172.16.0.0/12, 192.168.0.0/16), and cloud metadata endpoints (169.254.169.254 for AWS/Azure, metadata.google.internal for GCP) to retrieve IAM credentials, security tokens, and sensitive internal data. Responses are exfiltrated via alert() callbacks captured by page.onAlert and returned in the HTTP response.",
      "suggested_exploit_technique": "cloud_metadata_retrieval",
      "confidence": "High",
      "notes": "This is a post-sanitization mutation attack where the initial URL loaded by PhantomJS is safe (http://localhost:5000/static/<random>.html), but the HTML content contains user-controlled JavaScript that executes after page load. The weak regex filter (app.py:66) only removes literal [\"']XSS[\"'] strings and is trivially bypassed. PhantomJS runs without --web-security flag and has unrestricted network access. The application provides a built-in exfiltration channel via alert() callbacks that are logged to stdout and returned to the attacker. Exploitation is unauthenticated and requires no user interaction. Priority targets: (1) AWS metadata at http://169.254.169.254/latest/meta-data/iam/security-credentials/ for IAM credentials, (2) Internal services like Redis (port 6379), MongoDB (port 27017), (3) GCP metadata at http://metadata.google.internal/computeMetadata/v1/ (requires Metadata-Flavor: Google header via XMLHttpRequest), (4) Local file access via file:///etc/passwd protocol. Timeout is 5 seconds per request."
    }
  ]
}