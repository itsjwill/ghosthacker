
{
  "vulnerabilities": [
    {
      "ID": "XSS-VULN-01",
      "vulnerability_type": "Reflected",
      "externally_exploitable": true,
      "source": "POST parameter: name",
      "source_detail": "$_POST['name'] captured at contact.php:12 via $name = trim($_POST[\"name\"])",
      "path": "$_POST['name'] → trim() (line 12) → $name variable → echo (line 66) → HTML attribute context",
      "sink_function": "echo $name (contact.php:66 inside input value attribute)",
      "render_context": "HTML_ATTRIBUTE",
      "encoding_observed": "None - only trim() applied at line 12, no htmlspecialchars() or equivalent encoding",
      "verdict": "vulnerable",
      "mismatch_reason": "User input flows directly to HTML attribute context without htmlspecialchars() encoding. The trim() function only removes whitespace and provides no XSS protection. An attacker can break out of the value attribute using \">\" and inject arbitrary HTML/JavaScript. The correct defense for HTML_ATTRIBUTE context is htmlspecialchars($name, ENT_QUOTES, 'UTF-8').",
      "witness_payload": "\"><img src=x onerror=alert('XSS-NAME')>",
      "confidence": "high",
      "notes": "Live execution confirmed in browser testing with alert dialog. No CSP headers present. No session cookies exist (no authentication system), limiting traditional cookie theft impact but phishing and defacement remain viable. HTML5 form validation can be bypassed via direct POST requests."
    },
    {
      "ID": "XSS-VULN-02",
      "vulnerability_type": "Reflected",
      "externally_exploitable": true,
      "source": "POST parameter: email",
      "source_detail": "$_POST['email'] captured at contact.php:19 via $email = trim($_POST[\"email\"])",
      "path": "$_POST['email'] → trim() (line 19) → $email variable → echo (line 71) → HTML attribute context",
      "sink_function": "echo $email (contact.php:71 inside input value attribute)",
      "render_context": "HTML_ATTRIBUTE",
      "encoding_observed": "None - only trim() applied at line 19, no htmlspecialchars() or equivalent encoding",
      "verdict": "vulnerable",
      "mismatch_reason": "Identical vulnerability pattern to XSS-VULN-01. User input flows to HTML attribute context without encoding. The HTML5 type=\"email\" attribute provides client-side validation only and does not prevent XSS when submitting via curl or bypassing browser validation. The correct defense is htmlspecialchars($email, ENT_QUOTES, 'UTF-8').",
      "witness_payload": "\"><img src=x onerror=alert('XSS-EMAIL')>",
      "confidence": "high",
      "notes": "HTML injection confirmed via curl testing. Same security posture as XSS-VULN-01: no CSP, no session cookies, HTTP-only deployment. Email field does not perform server-side email format validation beyond empty check."
    },
    {
      "ID": "XSS-VULN-03",
      "vulnerability_type": "Reflected",
      "externally_exploitable": true,
      "source": "POST parameter: message",
      "source_detail": "$_POST['message'] captured at contact.php:26 via $message = trim($_POST[\"message\"])",
      "path": "$_POST['message'] → trim() (line 26) → $message variable → echo (line 76) → textarea body content (HTML_BODY context)",
      "sink_function": "echo $message (contact.php:76 inside textarea element)",
      "render_context": "HTML_BODY",
      "encoding_observed": "None - only trim() applied at line 26, no htmlspecialchars() or equivalent encoding",
      "verdict": "vulnerable",
      "mismatch_reason": "User input flows to HTML_BODY context (textarea content) without htmlspecialchars() encoding. An attacker can close the textarea tag using </textarea> and inject arbitrary HTML/JavaScript. The textarea element provides no automatic encoding of its content. The correct defense is htmlspecialchars($message, ENT_QUOTES, 'UTF-8').",
      "witness_payload": "</textarea><img src=x onerror=alert('XSS-MESSAGE')><textarea>",
      "confidence": "high",
      "notes": "HTML injection confirmed via curl testing. Different render context (HTML_BODY instead of HTML_ATTRIBUTE) requires different payload structure (closing textarea tag instead of breaking out of attribute). Same security environment as other vulnerabilities: no CSP, no authentication, HTTP-only."
    }
  ]
}