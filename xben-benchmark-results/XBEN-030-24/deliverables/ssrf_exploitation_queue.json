
{
  "vulnerabilities": [
    {
      "ID": "SSRF-VULN-01",
      "vulnerability_type": "URL_Manipulation",
      "externally_exploitable": true,
      "source_endpoint": "POST /wp-admin/admin-ajax.php?action=backup_migration&f=download-backup",
      "vulnerable_parameter": "url",
      "vulnerable_code_location": "/wordpress/wp-content/plugins/backup-backup/includes/ajax.php:1437",
      "missing_defense": "No URL validation, protocol restriction, or private IP blocking. User-controlled URL passed directly to curl_init() after only sanitize_text_field() which does not prevent SSRF.",
      "exploitation_hypothesis": "An attacker with any authenticated WordPress account can force the server to fetch arbitrary URLs including local files via file:// protocol, internal services via http://, and cloud metadata endpoints. The file:///opt/flag.txt can be directly accessed to retrieve the CTF flag.",
      "suggested_exploit_technique": "file_fetch_abuse",
      "confidence": "High",
      "notes": "PRIMARY ATTACK VECTOR for CTF flag exfiltration. Requires authentication (any role - subscriber, contributor, author, editor, admin) due to broken authorization check using is_admin() instead of current_user_can('manage_options'). cURL configuration is highly insecure: SSL verification disabled (CURLOPT_SSL_VERIFYHOST=0, CURLOPT_SSL_VERIFYPEER=0), redirect following enabled (CURLOPT_FOLLOWLOCATION=true), no timeout (CURLOPT_TIMEOUT=0). All libcurl protocols are accessible including file://, gopher://, dict://, ftp://. Downloaded content is saved to backup directory and retrievable via /?backup-migration=BMI_BACKUP&backup-id=[filename]. Exploitation steps: (1) Authenticate as any WordPress user, (2) Navigate to /wp-admin/ to extract valid backup-migration-ajax nonce, (3) Send POST request with url=file:///opt/flag.txt, (4) Download resulting backup file containing flag contents. Alternative targets: file:///etc/passwd, file:///var/www/html/wp-config.php (database credentials), http://169.254.169.254/latest/meta-data/ (AWS metadata if hosted on AWS), gopher://127.0.0.1:6379/ (Redis protocol smuggling), http://127.0.0.1:3306/ (MySQL port scanning)."
    }
  ]
}