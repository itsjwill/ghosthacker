
{
  "vulnerabilities": [
    {
      "ID": "XSS-VULN-01",
      "vulnerability_type": "Reflected",
      "externally_exploitable": true,
      "source": "HTTP POST/GET parameter 'message' from /sendMessageAction endpoint",
      "source_detail": "HTTP request parameter 'message' captured by Struts params interceptor at struts.xml:17-19, then bound to SendMessageAction.setMessage() at SendMessageAction.java:16",
      "path": "HTTP parameter 'message' → Struts params interceptor (struts.xml:17-19) → SendMessageAction.setMessage() (SendMessageAction.java:16-19) → OGNL evaluation via TextParseUtil.translateVariables() (line 18) → Storage in this.message field (SendMessageAction.java:10) → Rendering in success.jsp via <s:property> tag (success.jsp:44)",
      "sink_function": "<s:property value='message' escapeHtml='false'/> - Struts JSP property tag with HTML escaping explicitly disabled",
      "render_context": "HTML_BODY",
      "encoding_observed": "None - HTML escaping explicitly disabled via escapeHtml='false' at success.jsp:44. OGNL expression evaluation at SendMessageAction.java:18 is a transformation, not a sanitization.",
      "verdict": "vulnerable",
      "mismatch_reason": "The render context is HTML_BODY which requires HTML entity encoding to prevent XSS. The application explicitly disables HTML encoding with escapeHtml='false' on the Struts property tag. No alternative sanitization is performed. User-controlled data flows directly from the HTTP request through OGNL evaluation to HTML rendering without any context-appropriate encoding.",
      "witness_payload": "<script>alert(document.domain)</script>",
      "confidence": "high",
      "notes": "Live testing confirmed via curl inside Docker container. Both POST and GET methods are vulnerable. The application has zero CSP, zero security headers, and transmits over HTTP only. Session cookie JSESSIONID lacks Secure and SameSite flags. The XSS vulnerability is compounded by an OGNL injection RCE vulnerability in the same data flow (SendMessageAction.java:17-18), creating a dual server-side + client-side attack surface. Current external access blocked by Docker port mapping misconfiguration (36769→51222 instead of 8080), but the vulnerability is fully exploitable once network access is restored."
    }
  ]
}