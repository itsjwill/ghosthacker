
{
  "vulnerabilities": [
    {
      "ID": "AUTHZ-VULN-01",
      "vulnerability_type": "Horizontal",
      "externally_exploitable": true,
      "endpoint": "GET /company/{company_id}/jobs",
      "vulnerable_code_location": "/app/main.py:145-146",
      "role_context": "any authenticated user",
      "guard_evidence": "Token validation only checks that decoded token matches URL parameter company_id, but tokens use simple base64 encoding without cryptographic signature. Attacker can forge arbitrary tokens: base64.b64encode(str(target_company_id).encode())",
      "side_effect": "Read other companies' job listings including private jobs containing CTF flags (for admin companies)",
      "reason": "validate_token() performs no cryptographic verification of token authenticity. Attacker can forge tokens for any company_id by base64-encoding the target ID, bypassing ownership validation.",
      "minimal_witness": "Forge token: base64('2') = 'Mg==', set cookie access_token=Bearer Mg==, request GET /company/2/jobs to access company 2's jobs without knowing their credentials",
      "confidence": "high",
      "notes": "Combines with privilege escalation to access admin company's private jobs. Token forgery is trivial as create_access_token() at line 40-41 uses only base64 encoding, no JWT/HMAC signature."
    },
    {
      "ID": "AUTHZ-VULN-02",
      "vulnerability_type": "Horizontal",
      "externally_exploitable": true,
      "endpoint": "GET /edit_profile/{company_id}",
      "vulnerable_code_location": "/app/main.py:145-146",
      "role_context": "any authenticated user",
      "guard_evidence": "Same token forgery vulnerability as AUTHZ-VULN-01. No cryptographic signature verification in validate_token()",
      "side_effect": "Read other companies' profile data including company name and admin status (information disclosure)",
      "reason": "Token validation relies on base64-decoded value matching URL parameter, but attacker controls both through token forgery",
      "minimal_witness": "Forge token for target company_id, request GET /edit_profile/{target_id} to view victim's profile and identify admin accounts",
      "confidence": "high",
      "notes": "Reconnaissance vector for identifying high-value targets (admin companies) before privilege escalation attacks"
    },
    {
      "ID": "AUTHZ-VULN-03",
      "vulnerability_type": "Horizontal",
      "externally_exploitable": true,
      "endpoint": "POST /edit_profile/{company_id}",
      "vulnerable_code_location": "/app/main.py:145-146, 157-158",
      "role_context": "any authenticated user",
      "guard_evidence": "Same token forgery vulnerability enabling horizontal IDOR. No ownership verification beyond forgeable token",
      "side_effect": "Modify any company's profile data (name and admin status) causing data integrity compromise",
      "reason": "Combines token forgery with write access. Attacker can forge token for target company and modify their profile attributes",
      "minimal_witness": "Forge token for company_id X, POST /edit_profile/X with modified name or is_admin values to alter victim's profile",
      "confidence": "high",
      "notes": "CRITICAL: Write-based IDOR more severe than read-only. Enables data manipulation and defacement. Can modify ANY company's admin status."
    },
    {
      "ID": "AUTHZ-VULN-04",
      "vulnerability_type": "Vertical",
      "externally_exploitable": true,
      "endpoint": "POST /edit_profile/{company_id}",
      "vulnerable_code_location": "/app/main.py:158",
      "role_context": "any authenticated user",
      "guard_evidence": "No role check before privilege modification. Line 158 directly assigns: company.is_admin = is_admin without verifying user has permission to modify this security-critical field",
      "side_effect": "Self-elevate to admin role, gaining access to private jobs containing CTF flag",
      "reason": "Missing vertical authorization check. No guard validates 'is requesting user authorized to modify admin status?'. Client-side disabled attribute at /app/templates/edit_profile.html:19 is bypassable",
      "minimal_witness": "Authenticated user sends POST /edit_profile/{own_company_id} with is_admin=1 parameter to self-elevate, then accesses private jobs via GET /company/{own_company_id}/jobs",
      "confidence": "high",
      "notes": "CRITICAL privilege escalation. Server trusts user-controlled is_admin parameter. Enables complete compromise via admin access to flag data. Chains with private job access."
    },
    {
      "ID": "AUTHZ-VULN-05",
      "vulnerability_type": "Context_Workflow",
      "externally_exploitable": true,
      "endpoint": "All authenticated endpoints (validate_token dependency)",
      "vulnerable_code_location": "/app/main.py:40-41, 145",
      "role_context": "unauthenticated attacker",
      "guard_evidence": "Token creation uses base64-only encoding (no JWT signature, HMAC, or cryptographic binding). Token validation checks decoded value matches URL but never verifies token was legitimately issued by server",
      "side_effect": "Complete authentication bypass - access any company account without credentials",
      "reason": "Workflow bypass: Expected flow requires credential validation before token issuance. Actual: tokens can be forged without prior authentication. No cryptographic proof of legitimate issuance.",
      "minimal_witness": "Attacker identifies company_id=2 (admin account), creates forged token: base64('2')='Mg==', sets cookie access_token=Bearer Mg==, accesses all company 2 resources without knowing password",
      "confidence": "high",
      "notes": "CRITICAL authentication bypass. Despite importing jose.jwt and defining SECRET_KEY (line 15), application never uses cryptographic signing. Base64 is encoding not encryption. Enables complete account takeover for all users."
    }
  ]
}