
{
  "vulnerabilities": [
    {
      "ID": "AUTHZ-VULN-01",
      "vulnerability_type": "Horizontal",
      "externally_exploitable": true,
      "endpoint": "GET /order/<int:order_id>/receipt",
      "vulnerable_code_location": "routes.py:100",
      "role_context": "authenticated user",
      "guard_evidence": "Missing ownership validation - retrieves Order.query.get(order_id) without verifying order.user_id == session['user_id']",
      "side_effect": "Read any user's order receipt including sensitive financial data and CTF flag in Order #300401",
      "reason": "Endpoint checks authentication (session exists) but fails to verify the authenticated user owns the requested order, allowing horizontal privilege escalation across user boundaries",
      "minimal_witness": "Authenticate as test:test (user_id 10032), then access /order/300401/receipt to retrieve flag from order not owned by test user",
      "confidence": "high",
      "notes": "Order #300401 contains CTF flag in receipt field and has no user_id (orphaned record). Authentication guard at line 97-98 only validates session exists, database query at line 100 retrieves order without ownership check, template renders receipt at line 102 without authorization. Expected fix: add 'if order.user_id != user_id: abort(403)' between lines 100-102"
    }
  ]
}